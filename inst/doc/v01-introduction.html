<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Chris Bailiss" />

<meta name="date" content="2019-08-05" />

<title></title>

<script src="data:application/x-javascript;base64,KGZ1bmN0aW9uKCkgewogIC8vIElmIHdpbmRvdy5IVE1MV2lkZ2V0cyBpcyBhbHJlYWR5IGRlZmluZWQsIHRoZW4gdXNlIGl0OyBvdGhlcndpc2UgY3JlYXRlIGEKICAvLyBuZXcgb2JqZWN0LiBUaGlzIGFsbG93cyBwcmVjZWRpbmcgY29kZSB0byBzZXQgb3B0aW9ucyB0aGF0IGFmZmVjdCB0aGUKICAvLyBpbml0aWFsaXphdGlvbiBwcm9jZXNzICh0aG91Z2ggbm9uZSBjdXJyZW50bHkgZXhpc3QpLgogIHdpbmRvdy5IVE1MV2lkZ2V0cyA9IHdpbmRvdy5IVE1MV2lkZ2V0cyB8fCB7fTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSB2aWV3ZXIgcGFuZS4gSWYgbm90LCB3ZSdyZSBpbiBhIHdlYiBicm93c2VyLgogIHZhciB2aWV3ZXJNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnZpZXdlck1vZGUgPQogICAgICAvXGJ2aWV3ZXJfcGFuZT0xXGIvLnRlc3Qod2luZG93LmxvY2F0aW9uKTsKCiAgLy8gU2VlIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gU2hpbnkgbW9kZS4gSWYgbm90LCBpdCdzIGEgc3RhdGljIGRvY3VtZW50LgogIC8vIE5vdGUgdGhhdCBzdGF0aWMgd2lkZ2V0cyBjYW4gYXBwZWFyIGluIGJvdGggU2hpbnkgYW5kIHN0YXRpYyBtb2RlcywgYnV0CiAgLy8gb2J2aW91c2x5LCBTaGlueSB3aWRnZXRzIGNhbiBvbmx5IGFwcGVhciBpbiBTaGlueSBhcHBzL2RvY3VtZW50cy4KICB2YXIgc2hpbnlNb2RlID0gd2luZG93LkhUTUxXaWRnZXRzLnNoaW55TW9kZSA9CiAgICAgIHR5cGVvZih3aW5kb3cuU2hpbnkpICE9PSAidW5kZWZpbmVkIiAmJiAhIXdpbmRvdy5TaGlueS5vdXRwdXRCaW5kaW5nczsKCiAgLy8gV2UgY2FuJ3QgY291bnQgb24galF1ZXJ5IGJlaW5nIGF2YWlsYWJsZSwgc28gd2UgaW1wbGVtZW50IG91ciBvd24KICAvLyB2ZXJzaW9uIGlmIG5lY2Vzc2FyeS4KICBmdW5jdGlvbiBxdWVyeVNlbGVjdG9yQWxsKHNjb3BlLCBzZWxlY3RvcikgewogICAgaWYgKHR5cGVvZihqUXVlcnkpICE9PSAidW5kZWZpbmVkIiAmJiBzY29wZSBpbnN0YW5jZW9mIGpRdWVyeSkgewogICAgICByZXR1cm4gc2NvcGUuZmluZChzZWxlY3Rvcik7CiAgICB9CiAgICBpZiAoc2NvcGUucXVlcnlTZWxlY3RvckFsbCkgewogICAgICByZXR1cm4gc2NvcGUucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBhc0FycmF5KHZhbHVlKSB7CiAgICBpZiAodmFsdWUgPT09IG51bGwpCiAgICAgIHJldHVybiBbXTsKICAgIGlmICgkLmlzQXJyYXkodmFsdWUpKQogICAgICByZXR1cm4gdmFsdWU7CiAgICByZXR1cm4gW3ZhbHVlXTsKICB9CgogIC8vIEltcGxlbWVudCBqUXVlcnkncyBleHRlbmQKICBmdW5jdGlvbiBleHRlbmQodGFyZ2V0IC8qLCAuLi4gKi8pIHsKICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkgewogICAgICAgICAgdGFyZ2V0W3Byb3BdID0gc291cmNlW3Byb3BdOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHRhcmdldDsKICB9CgogIC8vIElFOCBkb2Vzbid0IHN1cHBvcnQgQXJyYXkuZm9yRWFjaC4KICBmdW5jdGlvbiBmb3JFYWNoKHZhbHVlcywgY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgIGlmICh2YWx1ZXMuZm9yRWFjaCkgewogICAgICB2YWx1ZXMuZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZyk7CiAgICB9IGVsc2UgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgdmFsdWVzW2ldLCBpLCB2YWx1ZXMpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZXBsYWNlcyB0aGUgc3BlY2lmaWVkIG1ldGhvZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgZnVuY1NvdXJjZS4KICAvLwogIC8vIE5vdGUgdGhhdCBmdW5jU291cmNlIHNob3VsZCBub3QgQkUgdGhlIG5ldyBtZXRob2QsIGl0IHNob3VsZCBiZSBhIGZ1bmN0aW9uCiAgLy8gdGhhdCBSRVRVUk5TIHRoZSBuZXcgbWV0aG9kLiBmdW5jU291cmNlIHJlY2VpdmVzIGEgc2luZ2xlIGFyZ3VtZW50IHRoYXQgaXMKICAvLyB0aGUgb3ZlcnJpZGRlbiBtZXRob2QsIGl0IGNhbiBiZSBjYWxsZWQgZnJvbSB0aGUgbmV3IG1ldGhvZC4gVGhlIG92ZXJyaWRkZW4KICAvLyBtZXRob2QgY2FuIGJlIGNhbGxlZCBsaWtlIGEgcmVndWxhciBmdW5jdGlvbiwgaXQgaGFzIHRoZSB0YXJnZXQgcGVybWFuZW50bHkKICAvLyBib3VuZCB0byBpdCBzbyAidGhpcyIgd2lsbCB3b3JrIGNvcnJlY3RseS4KICBmdW5jdGlvbiBvdmVycmlkZU1ldGhvZCh0YXJnZXQsIG1ldGhvZE5hbWUsIGZ1bmNTb3VyY2UpIHsKICAgIHZhciBzdXBlckZ1bmMgPSB0YXJnZXRbbWV0aG9kTmFtZV0gfHwgZnVuY3Rpb24oKSB7fTsKICAgIHZhciBzdXBlckZ1bmNCb3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gc3VwZXJGdW5jLmFwcGx5KHRhcmdldCwgYXJndW1lbnRzKTsKICAgIH07CiAgICB0YXJnZXRbbWV0aG9kTmFtZV0gPSBmdW5jU291cmNlKHN1cGVyRnVuY0JvdW5kKTsKICB9CgogIC8vIEFkZCBhIG1ldGhvZCB0byBkZWxlZ2F0b3IgdGhhdCwgd2hlbiBpbnZva2VkLCBjYWxscwogIC8vIGRlbGVnYXRlZS5tZXRob2ROYW1lLiBJZiB0aGVyZSBpcyBubyBzdWNoIG1ldGhvZCBvbgogIC8vIHRoZSBkZWxlZ2F0ZWUsIGJ1dCB0aGVyZSB3YXMgb25lIG9uIGRlbGVnYXRvciBiZWZvcmUKICAvLyBkZWxlZ2F0ZU1ldGhvZCB3YXMgY2FsbGVkLCB0aGVuIHRoZSBvcmlnaW5hbCB2ZXJzaW9uCiAgLy8gaXMgaW52b2tlZCBpbnN0ZWFkLgogIC8vIEZvciBleGFtcGxlOgogIC8vCiAgLy8gdmFyIGEgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2ExJyk7IH0KICAvLyAgIG1ldGhvZDI6IGZ1bmN0aW9uKCkgeyBjb25zb2xlLmxvZygnYTInKTsgfQogIC8vIH07CiAgLy8gdmFyIGIgPSB7CiAgLy8gICBtZXRob2QxOiBmdW5jdGlvbigpIHsgY29uc29sZS5sb2coJ2IxJyk7IH0KICAvLyB9OwogIC8vIGRlbGVnYXRlTWV0aG9kKGEsIGIsICJtZXRob2QxIik7CiAgLy8gZGVsZWdhdGVNZXRob2QoYSwgYiwgIm1ldGhvZDIiKTsKICAvLyBhLm1ldGhvZDEoKTsKICAvLyBhLm1ldGhvZDIoKTsKICAvLwogIC8vIFRoZSBvdXRwdXQgd291bGQgYmUgImIxIiwgImEyIi4KICBmdW5jdGlvbiBkZWxlZ2F0ZU1ldGhvZChkZWxlZ2F0b3IsIGRlbGVnYXRlZSwgbWV0aG9kTmFtZSkgewogICAgdmFyIGluaGVyaXRlZCA9IGRlbGVnYXRvclttZXRob2ROYW1lXTsKICAgIGRlbGVnYXRvclttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgdGFyZ2V0ID0gZGVsZWdhdGVlOwogICAgICB2YXIgbWV0aG9kID0gZGVsZWdhdGVlW21ldGhvZE5hbWVdOwoKICAgICAgLy8gVGhlIG1ldGhvZCBkb2Vzbid0IGV4aXN0IG9uIHRoZSBkZWxlZ2F0ZWUuIEluc3RlYWQsCiAgICAgIC8vIGNhbGwgdGhlIG1ldGhvZCBvbiB0aGUgZGVsZWdhdG9yLCBpZiBpdCBleGlzdHMuCiAgICAgIGlmICghbWV0aG9kKSB7CiAgICAgICAgdGFyZ2V0ID0gZGVsZWdhdG9yOwogICAgICAgIG1ldGhvZCA9IGluaGVyaXRlZDsKICAgICAgfQoKICAgICAgaWYgKG1ldGhvZCkgewogICAgICAgIHJldHVybiBtZXRob2QuYXBwbHkodGFyZ2V0LCBhcmd1bWVudHMpOwogICAgICB9CiAgICB9OwogIH0KCiAgLy8gSW1wbGVtZW50IGEgdmFndWUgZmFjc2ltaWxpZSBvZiBqUXVlcnkncyBkYXRhIG1ldGhvZAogIGZ1bmN0aW9uIGVsZW1lbnREYXRhKGVsLCBuYW1lLCB2YWx1ZSkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikgewogICAgICByZXR1cm4gZWxbImh0bWx3aWRnZXRfZGF0YV8iICsgbmFtZV07CiAgICB9IGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMykgewogICAgICBlbFsiaHRtbHdpZGdldF9kYXRhXyIgKyBuYW1lXSA9IHZhbHVlOwogICAgICByZXR1cm4gZWw7CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIldyb25nIG51bWJlciBvZiBhcmd1bWVudHMgZm9yIGVsZW1lbnREYXRhOiAiICsKICAgICAgICBhcmd1bWVudHMubGVuZ3RoKTsKICAgIH0KICB9CgogIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzQ0NjE3MC9lc2NhcGUtc3RyaW5nLWZvci11c2UtaW4tamF2YXNjcmlwdC1yZWdleAogIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHIpIHsKICAgIHJldHVybiBzdHIucmVwbGFjZSgvW1wtXFtcXVwvXHtcfVwoXClcKlwrXD9cLlxcXF5cJFx8XS9nLCAiXFwkJiIpOwogIH0KCiAgZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkgewogICAgdmFyIHJlID0gbmV3IFJlZ0V4cCgiXFxiIiArIGVzY2FwZVJlZ0V4cChjbGFzc05hbWUpICsgIlxcYiIpOwogICAgcmV0dXJuIHJlLnRlc3QoZWwuY2xhc3NOYW1lKTsKICB9CgogIC8vIGVsZW1lbnRzIC0gYXJyYXkgKG9yIGFycmF5LWxpa2Ugb2JqZWN0KSBvZiBIVE1MIGVsZW1lbnRzCiAgLy8gY2xhc3NOYW1lIC0gY2xhc3MgbmFtZSB0byB0ZXN0IGZvcgogIC8vIGluY2x1ZGUgLSBpZiB0cnVlLCBvbmx5IHJldHVybiBlbGVtZW50cyB3aXRoIGdpdmVuIGNsYXNzTmFtZTsKICAvLyAgIGlmIGZhbHNlLCBvbmx5IHJldHVybiBlbGVtZW50cyAqd2l0aG91dCogZ2l2ZW4gY2xhc3NOYW1lCiAgZnVuY3Rpb24gZmlsdGVyQnlDbGFzcyhlbGVtZW50cywgY2xhc3NOYW1lLCBpbmNsdWRlKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoaGFzQ2xhc3MoZWxlbWVudHNbaV0sIGNsYXNzTmFtZSkgPT0gaW5jbHVkZSkKICAgICAgICByZXN1bHRzLnB1c2goZWxlbWVudHNbaV0pOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfQoKICBmdW5jdGlvbiBvbihvYmosIGV2ZW50TmFtZSwgZnVuYykgewogICAgaWYgKG9iai5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgIG9iai5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgZnVuYywgZmFsc2UpOwogICAgfSBlbHNlIGlmIChvYmouYXR0YWNoRXZlbnQpIHsKICAgICAgb2JqLmF0dGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICBmdW5jdGlvbiBvZmYob2JqLCBldmVudE5hbWUsIGZ1bmMpIHsKICAgIGlmIChvYmoucmVtb3ZlRXZlbnRMaXN0ZW5lcikKICAgICAgb2JqLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBmdW5jLCBmYWxzZSk7CiAgICBlbHNlIGlmIChvYmouZGV0YWNoRXZlbnQpIHsKICAgICAgb2JqLmRldGFjaEV2ZW50KGV2ZW50TmFtZSwgZnVuYyk7CiAgICB9CiAgfQoKICAvLyBUcmFuc2xhdGUgYXJyYXkgb2YgdmFsdWVzIHRvIHRvcC9yaWdodC9ib3R0b20vbGVmdCwgYXMgdXN1YWwgd2l0aAogIC8vIHRoZSAicGFkZGluZyIgQ1NTIHByb3BlcnR5CiAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL3BhZGRpbmcKICBmdW5jdGlvbiB1bnBhY2tQYWRkaW5nKHZhbHVlKSB7CiAgICBpZiAodHlwZW9mKHZhbHVlKSA9PT0gIm51bWJlciIpCiAgICAgIHZhbHVlID0gW3ZhbHVlXTsKICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDEpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMF0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzBdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDIpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMF0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDMpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzFdfTsKICAgIH0KICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDQpIHsKICAgICAgcmV0dXJuIHt0b3A6IHZhbHVlWzBdLCByaWdodDogdmFsdWVbMV0sIGJvdHRvbTogdmFsdWVbMl0sIGxlZnQ6IHZhbHVlWzNdfTsKICAgIH0KICB9CgogIC8vIENvbnZlcnQgYW4gdW5wYWNrZWQgcGFkZGluZyBvYmplY3QgdG8gYSBDU1MgdmFsdWUKICBmdW5jdGlvbiBwYWRkaW5nVG9Dc3MocGFkZGluZ09iaikgewogICAgcmV0dXJuIHBhZGRpbmdPYmoudG9wICsgInB4ICIgKyBwYWRkaW5nT2JqLnJpZ2h0ICsgInB4ICIgKyBwYWRkaW5nT2JqLmJvdHRvbSArICJweCAiICsgcGFkZGluZ09iai5sZWZ0ICsgInB4IjsKICB9CgogIC8vIE1ha2VzIGEgbnVtYmVyIHN1aXRhYmxlIGZvciBDU1MKICBmdW5jdGlvbiBweCh4KSB7CiAgICBpZiAodHlwZW9mKHgpID09PSAibnVtYmVyIikKICAgICAgcmV0dXJuIHggKyAicHgiOwogICAgZWxzZQogICAgICByZXR1cm4geDsKICB9CgogIC8vIFJldHJpZXZlcyBydW50aW1lIHdpZGdldCBzaXppbmcgaW5mb3JtYXRpb24gZm9yIGFuIGVsZW1lbnQuCiAgLy8gVGhlIHJldHVybiB2YWx1ZSBpcyBlaXRoZXIgbnVsbCwgb3IgYW4gb2JqZWN0IHdpdGggZmlsbCwgcGFkZGluZywKICAvLyBkZWZhdWx0V2lkdGgsIGRlZmF1bHRIZWlnaHQgZmllbGRzLgogIGZ1bmN0aW9uIHNpemluZ1BvbGljeShlbCkgewogICAgdmFyIHNpemluZ0VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcigic2NyaXB0W2RhdGEtZm9yPSciICsgZWwuaWQgKyAiJ11bdHlwZT0nYXBwbGljYXRpb24vaHRtbHdpZGdldC1zaXppbmcnXSIpOwogICAgaWYgKCFzaXppbmdFbCkKICAgICAgcmV0dXJuIG51bGw7CiAgICB2YXIgc3AgPSBKU09OLnBhcnNlKHNpemluZ0VsLnRleHRDb250ZW50IHx8IHNpemluZ0VsLnRleHQgfHwgInt9Iik7CiAgICBpZiAodmlld2VyTW9kZSkgewogICAgICByZXR1cm4gc3Audmlld2VyOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHNwLmJyb3dzZXI7CiAgICB9CiAgfQoKICAvLyBAcGFyYW0gdGFza3MgQXJyYXkgb2Ygc3RyaW5ncyAob3IgZmFsc3kgdmFsdWUsIGluIHdoaWNoIGNhc2Ugbm8tb3ApLgogIC8vICAgRWFjaCBlbGVtZW50IG11c3QgYmUgYSB2YWxpZCBKYXZhU2NyaXB0IGV4cHJlc3Npb24gdGhhdCB5aWVsZHMgYQogIC8vICAgZnVuY3Rpb24uIE9yLCBjYW4gYmUgYW4gYXJyYXkgb2Ygb2JqZWN0cyB3aXRoICJjb2RlIiBhbmQgImRhdGEiCiAgLy8gICBwcm9wZXJ0aWVzOyBpbiB0aGlzIGNhc2UsIHRoZSAiY29kZSIgcHJvcGVydHkgc2hvdWxkIGJlIGEgc3RyaW5nCiAgLy8gICBvZiBKUyB0aGF0J3MgYW4gZXhwciB0aGF0IHlpZWxkcyBhIGZ1bmN0aW9uLCBhbmQgImRhdGEiIHNob3VsZCBiZQogIC8vICAgYW4gb2JqZWN0IHRoYXQgd2lsbCBiZSBhZGRlZCBhcyBhbiBhZGRpdGlvbmFsIGFyZ3VtZW50IHdoZW4gdGhhdAogIC8vICAgZnVuY3Rpb24gaXMgY2FsbGVkLgogIC8vIEBwYXJhbSB0YXJnZXQgVGhlIG9iamVjdCB0aGF0IHdpbGwgYmUgInRoaXMiIGZvciBlYWNoIGZ1bmN0aW9uCiAgLy8gICBleGVjdXRpb24uCiAgLy8gQHBhcmFtIGFyZ3MgQXJyYXkgb2YgYXJndW1lbnRzIHRvIGJlIHBhc3NlZCB0byB0aGUgZnVuY3Rpb25zLiAoVGhlCiAgLy8gICBzYW1lIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZCB0byBhbGwgZnVuY3Rpb25zLikKICBmdW5jdGlvbiBldmFsQW5kUnVuKHRhc2tzLCB0YXJnZXQsIGFyZ3MpIHsKICAgIGlmICh0YXNrcykgewogICAgICBmb3JFYWNoKHRhc2tzLCBmdW5jdGlvbih0YXNrKSB7CiAgICAgICAgdmFyIHRoZXNlQXJncyA9IGFyZ3M7CiAgICAgICAgaWYgKHR5cGVvZih0YXNrKSA9PT0gIm9iamVjdCIpIHsKICAgICAgICAgIHRoZXNlQXJncyA9IHRoZXNlQXJncy5jb25jYXQoW3Rhc2suZGF0YV0pOwogICAgICAgICAgdGFzayA9IHRhc2suY29kZTsKICAgICAgICB9CiAgICAgICAgdmFyIHRhc2tGdW5jID0gZXZhbCgiKCIgKyB0YXNrICsgIikiKTsKICAgICAgICBpZiAodHlwZW9mKHRhc2tGdW5jKSAhPT0gImZ1bmN0aW9uIikgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJUYXNrIG11c3QgYmUgYSBmdW5jdGlvbiEgU291cmNlOlxuIiArIHRhc2spOwogICAgICAgIH0KICAgICAgICB0YXNrRnVuYy5hcHBseSh0YXJnZXQsIHRoZXNlQXJncyk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgZnVuY3Rpb24gaW5pdFNpemluZyhlbCkgewogICAgdmFyIHNpemluZyA9IHNpemluZ1BvbGljeShlbCk7CiAgICBpZiAoIXNpemluZykKICAgICAgcmV0dXJuOwoKICAgIHZhciBjZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaHRtbHdpZGdldF9jb250YWluZXIiKTsKICAgIGlmICghY2VsKQogICAgICByZXR1cm47CgogICAgaWYgKHR5cGVvZihzaXppbmcucGFkZGluZykgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUubWFyZ2luID0gIjAiOwogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmcgPSBwYWRkaW5nVG9Dc3ModW5wYWNrUGFkZGluZyhzaXppbmcucGFkZGluZykpOwogICAgfQoKICAgIGlmIChzaXppbmcuZmlsbCkgewogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSAiMTAwJSI7CiAgICAgIGlmIChjZWwpIHsKICAgICAgICBjZWwuc3R5bGUucG9zaXRpb24gPSAiYWJzb2x1dGUiOwogICAgICAgIHZhciBwYWQgPSB1bnBhY2tQYWRkaW5nKHNpemluZy5wYWRkaW5nKTsKICAgICAgICBjZWwuc3R5bGUudG9wID0gcGFkLnRvcCArICJweCI7CiAgICAgICAgY2VsLnN0eWxlLnJpZ2h0ID0gcGFkLnJpZ2h0ICsgInB4IjsKICAgICAgICBjZWwuc3R5bGUuYm90dG9tID0gcGFkLmJvdHRvbSArICJweCI7CiAgICAgICAgY2VsLnN0eWxlLmxlZnQgPSBwYWQubGVmdCArICJweCI7CiAgICAgICAgZWwuc3R5bGUud2lkdGggPSAiMTAwJSI7CiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gIjEwMCUiOwogICAgICB9CgogICAgICByZXR1cm4gewogICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHsgcmV0dXJuIGNlbC5vZmZzZXRXaWR0aDsgfSwKICAgICAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gY2VsLm9mZnNldEhlaWdodDsgfQogICAgICB9OwoKICAgIH0gZWxzZSB7CiAgICAgIGVsLnN0eWxlLndpZHRoID0gcHgoc2l6aW5nLndpZHRoKTsKICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gcHgoc2l6aW5nLmhlaWdodCk7CgogICAgICByZXR1cm4gewogICAgICAgIGdldFdpZHRoOiBmdW5jdGlvbigpIHsgcmV0dXJuIGVsLm9mZnNldFdpZHRoOyB9LAogICAgICAgIGdldEhlaWdodDogZnVuY3Rpb24oKSB7IHJldHVybiBlbC5vZmZzZXRIZWlnaHQ7IH0KICAgICAgfTsKICAgIH0KICB9CgogIC8vIERlZmF1bHQgaW1wbGVtZW50YXRpb25zIGZvciBtZXRob2RzCiAgdmFyIGRlZmF1bHRzID0gewogICAgZmluZDogZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgcmV0dXJuIHF1ZXJ5U2VsZWN0b3JBbGwoc2NvcGUsICIuIiArIHRoaXMubmFtZSk7CiAgICB9LAogICAgcmVuZGVyRXJyb3I6IGZ1bmN0aW9uKGVsLCBlcnIpIHsKICAgICAgdmFyICRlbCA9ICQoZWwpOwoKICAgICAgdGhpcy5jbGVhckVycm9yKGVsKTsKCiAgICAgIC8vIEFkZCBhbGwgdGhlc2UgZXJyb3IgY2xhc3NlcywgYXMgU2hpbnkgZG9lcwogICAgICB2YXIgZXJyQ2xhc3MgPSAic2hpbnktb3V0cHV0LWVycm9yIjsKICAgICAgaWYgKGVyci50eXBlICE9PSBudWxsKSB7CiAgICAgICAgLy8gdXNlIHRoZSBjbGFzc2VzIG9mIHRoZSBlcnJvciBjb25kaXRpb24gYXMgQ1NTIGNsYXNzIG5hbWVzCiAgICAgICAgZXJyQ2xhc3MgPSBlcnJDbGFzcyArICIgIiArICQubWFwKGFzQXJyYXkoZXJyLnR5cGUpLCBmdW5jdGlvbih0eXBlKSB7CiAgICAgICAgICByZXR1cm4gZXJyQ2xhc3MgKyAiLSIgKyB0eXBlOwogICAgICAgIH0pLmpvaW4oIiAiKTsKICAgICAgfQogICAgICBlcnJDbGFzcyA9IGVyckNsYXNzICsgIiBodG1sd2lkZ2V0cy1lcnJvciI7CgogICAgICAvLyBJcyBlbCBpbmxpbmUgb3IgYmxvY2s/IElmIGlubGluZSBvciBpbmxpbmUtYmxvY2ssIGp1c3QgZGlzcGxheTpub25lIGl0CiAgICAgIC8vIGFuZCBhZGQgYW4gaW5saW5lIGVycm9yLgogICAgICB2YXIgZGlzcGxheSA9ICRlbC5jc3MoImRpc3BsYXkiKTsKICAgICAgJGVsLmRhdGEoInJlc3RvcmUtZGlzcGxheS1tb2RlIiwgZGlzcGxheSk7CgogICAgICBpZiAoZGlzcGxheSA9PT0gImlubGluZSIgfHwgZGlzcGxheSA9PT0gImlubGluZS1ibG9jayIpIHsKICAgICAgICAkZWwuaGlkZSgpOwogICAgICAgIGlmIChlcnIubWVzc2FnZSAhPT0gIiIpIHsKICAgICAgICAgIHZhciBlcnJvclNwYW4gPSAkKCI8c3Bhbj4iKS5hZGRDbGFzcyhlcnJDbGFzcyk7CiAgICAgICAgICBlcnJvclNwYW4udGV4dChlcnIubWVzc2FnZSk7CiAgICAgICAgICAkZWwuYWZ0ZXIoZXJyb3JTcGFuKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoZGlzcGxheSA9PT0gImJsb2NrIikgewogICAgICAgIC8vIElmIGJsb2NrLCBhZGQgYW4gZXJyb3IganVzdCBhZnRlciB0aGUgZWwsIHNldCB2aXNpYmlsaXR5Om5vbmUgb24gdGhlCiAgICAgICAgLy8gZWwsIGFuZCBwb3NpdGlvbiB0aGUgZXJyb3IgdG8gYmUgb24gdG9wIG9mIHRoZSBlbC4KICAgICAgICAvLyBNYXJrIGl0IHdpdGggYSB1bmlxdWUgSUQgYW5kIENTUyBjbGFzcyBzbyB3ZSBjYW4gcmVtb3ZlIGl0IGxhdGVyLgogICAgICAgICRlbC5jc3MoInZpc2liaWxpdHkiLCAiaGlkZGVuIik7CiAgICAgICAgaWYgKGVyci5tZXNzYWdlICE9PSAiIikgewogICAgICAgICAgdmFyIGVycm9yRGl2ID0gJCgiPGRpdj4iKS5hZGRDbGFzcyhlcnJDbGFzcykuY3NzKCJwb3NpdGlvbiIsICJhYnNvbHV0ZSIpCiAgICAgICAgICAgIC5jc3MoInRvcCIsIGVsLm9mZnNldFRvcCkKICAgICAgICAgICAgLmNzcygibGVmdCIsIGVsLm9mZnNldExlZnQpCiAgICAgICAgICAgIC8vIHNldHRpbmcgd2lkdGggY2FuIHB1c2ggb3V0IHRoZSBwYWdlIHNpemUsIGZvcmNpbmcgb3RoZXJ3aXNlCiAgICAgICAgICAgIC8vIHVubmVjZXNzYXJ5IHNjcm9sbGJhcnMgdG8gYXBwZWFyIGFuZCBtYWtpbmcgaXQgaW1wb3NzaWJsZSBmb3IKICAgICAgICAgICAgLy8gdGhlIGVsZW1lbnQgdG8gc2hyaW5rOyBzbyB1c2UgbWF4LXdpZHRoIGluc3RlYWQKICAgICAgICAgICAgLmNzcygibWF4V2lkdGgiLCBlbC5vZmZzZXRXaWR0aCkKICAgICAgICAgICAgLmNzcygiaGVpZ2h0IiwgZWwub2Zmc2V0SGVpZ2h0KTsKICAgICAgICAgIGVycm9yRGl2LnRleHQoZXJyLm1lc3NhZ2UpOwogICAgICAgICAgJGVsLmFmdGVyKGVycm9yRGl2KTsKCiAgICAgICAgICAvLyBSZWFsbHkgZHVtYiB3YXkgdG8ga2VlcCB0aGUgc2l6ZS9wb3NpdGlvbiBvZiB0aGUgZXJyb3IgaW4gc3luYyB3aXRoCiAgICAgICAgICAvLyB0aGUgcGFyZW50IGVsZW1lbnQgYXMgdGhlIHdpbmRvdyBpcyByZXNpemVkIG9yIHdoYXRldmVyLgogICAgICAgICAgdmFyIGludElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmICghZXJyb3JEaXZbMF0ucGFyZW50RWxlbWVudCkgewogICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50SWQpOwogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBlcnJvckRpdgogICAgICAgICAgICAgIC5jc3MoInRvcCIsIGVsLm9mZnNldFRvcCkKICAgICAgICAgICAgICAuY3NzKCJsZWZ0IiwgZWwub2Zmc2V0TGVmdCkKICAgICAgICAgICAgICAuY3NzKCJtYXhXaWR0aCIsIGVsLm9mZnNldFdpZHRoKQogICAgICAgICAgICAgIC5jc3MoImhlaWdodCIsIGVsLm9mZnNldEhlaWdodCk7CiAgICAgICAgICB9LCA1MDApOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNsZWFyRXJyb3I6IGZ1bmN0aW9uKGVsKSB7CiAgICAgIHZhciAkZWwgPSAkKGVsKTsKICAgICAgdmFyIGRpc3BsYXkgPSAkZWwuZGF0YSgicmVzdG9yZS1kaXNwbGF5LW1vZGUiKTsKICAgICAgJGVsLmRhdGEoInJlc3RvcmUtZGlzcGxheS1tb2RlIiwgbnVsbCk7CgogICAgICBpZiAoZGlzcGxheSA9PT0gImlubGluZSIgfHwgZGlzcGxheSA9PT0gImlubGluZS1ibG9jayIpIHsKICAgICAgICBpZiAoZGlzcGxheSkKICAgICAgICAgICRlbC5jc3MoImRpc3BsYXkiLCBkaXNwbGF5KTsKICAgICAgICAkKGVsLm5leHRTaWJsaW5nKS5maWx0ZXIoIi5odG1sd2lkZ2V0cy1lcnJvciIpLnJlbW92ZSgpOwogICAgICB9IGVsc2UgaWYgKGRpc3BsYXkgPT09ICJibG9jayIpewogICAgICAgICRlbC5jc3MoInZpc2liaWxpdHkiLCAiaW5oZXJpdCIpOwogICAgICAgICQoZWwubmV4dFNpYmxpbmcpLmZpbHRlcigiLmh0bWx3aWRnZXRzLWVycm9yIikucmVtb3ZlKCk7CiAgICAgIH0KICAgIH0sCiAgICBzaXppbmc6IHt9CiAgfTsKCiAgLy8gQ2FsbGVkIGJ5IHdpZGdldCBiaW5kaW5ncyB0byByZWdpc3RlciBhIG5ldyB0eXBlIG9mIHdpZGdldC4gVGhlIGRlZmluaXRpb24KICAvLyBvYmplY3QgY2FuIGNvbnRhaW4gdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOgogIC8vIC0gbmFtZSAocmVxdWlyZWQpIC0gQSBzdHJpbmcgaW5kaWNhdGluZyB0aGUgYmluZGluZyBuYW1lLCB3aGljaCB3aWxsIGJlCiAgLy8gICB1c2VkIGJ5IGRlZmF1bHQgYXMgdGhlIENTUyBjbGFzc25hbWUgdG8gbG9vayBmb3IuCiAgLy8gLSBpbml0aWFsaXplIChvcHRpb25hbCkgLSBBIGZ1bmN0aW9uKGVsKSB0aGF0IHdpbGwgYmUgY2FsbGVkIG9uY2UgcGVyCiAgLy8gICB3aWRnZXQgZWxlbWVudDsgaWYgYSB2YWx1ZSBpcyByZXR1cm5lZCwgaXQgd2lsbCBiZSBwYXNzZWQgYXMgdGhlIHRoaXJkCiAgLy8gICB2YWx1ZSB0byByZW5kZXJWYWx1ZS4KICAvLyAtIHJlbmRlclZhbHVlIChyZXF1aXJlZCkgLSBBIGZ1bmN0aW9uKGVsLCBkYXRhLCBpbml0VmFsdWUpIHRoYXQgd2lsbCBiZQogIC8vICAgY2FsbGVkIHdpdGggZGF0YS4gU3RhdGljIGNvbnRleHRzIHdpbGwgY2F1c2UgdGhpcyB0byBiZSBjYWxsZWQgb25jZSBwZXIKICAvLyAgIGVsZW1lbnQ7IFNoaW55IGFwcHMgd2lsbCBjYXVzZSB0aGlzIHRvIGJlIGNhbGxlZCBtdWx0aXBsZSB0aW1lcyBwZXIKICAvLyAgIGVsZW1lbnQsIGFzIHRoZSBkYXRhIGNoYW5nZXMuCiAgd2luZG93LkhUTUxXaWRnZXRzLndpZGdldCA9IGZ1bmN0aW9uKGRlZmluaXRpb24pIHsKICAgIGlmICghZGVmaW5pdGlvbi5uYW1lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIG5hbWUiKTsKICAgIH0KICAgIGlmICghZGVmaW5pdGlvbi50eXBlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIHR5cGUiKTsKICAgIH0KICAgIC8vIEN1cnJlbnRseSB3ZSBvbmx5IHN1cHBvcnQgb3V0cHV0IHdpZGdldHMKICAgIGlmIChkZWZpbml0aW9uLnR5cGUgIT09ICJvdXRwdXQiKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiVW5yZWNvZ25pemVkIHdpZGdldCB0eXBlICciICsgZGVmaW5pdGlvbi50eXBlICsgIiciKTsKICAgIH0KICAgIC8vIFRPRE86IFZlcmlmeSB0aGF0IC5uYW1lIGlzIGEgdmFsaWQgQ1NTIGNsYXNzbmFtZQoKICAgIC8vIFN1cHBvcnQgbmV3LXN0eWxlIGluc3RhbmNlLWJvdW5kIGRlZmluaXRpb25zLiBPbGQtc3R5bGUgY2xhc3MtYm91bmQKICAgIC8vIGRlZmluaXRpb25zIGhhdmUgb25lIHdpZGdldCAib2JqZWN0IiBwZXIgd2lkZ2V0IHBlciB0eXBlL2NsYXNzIG9mCiAgICAvLyB3aWRnZXQ7IHRoZSByZW5kZXJWYWx1ZSBhbmQgcmVzaXplIG1ldGhvZHMgb24gc3VjaCB3aWRnZXQgb2JqZWN0cwogICAgLy8gdGFrZSBlbCBhbmQgaW5zdGFuY2UgYXJndW1lbnRzLCBiZWNhdXNlIHRoZSB3aWRnZXQgb2JqZWN0IGNhbid0CiAgICAvLyBzdG9yZSB0aGVtLiBOZXctc3R5bGUgaW5zdGFuY2UtYm91bmQgZGVmaW5pdGlvbnMgaGF2ZSBvbmUgd2lkZ2V0CiAgICAvLyBvYmplY3QgcGVyIHdpZGdldCBpbnN0YW5jZTsgdGhlIGRlZmluaXRpb24gdGhhdCdzIHBhc3NlZCBpbiBkb2Vzbid0CiAgICAvLyBwcm92aWRlIHJlbmRlclZhbHVlIG9yIHJlc2l6ZSBtZXRob2RzIGF0IGFsbCwganVzdCB0aGUgc2luZ2xlIG1ldGhvZAogICAgLy8gICBmYWN0b3J5KGVsLCB3aWR0aCwgaGVpZ2h0KQogICAgLy8gd2hpY2ggcmV0dXJucyBhbiBvYmplY3QgdGhhdCBoYXMgcmVuZGVyVmFsdWUoeCkgYW5kIHJlc2l6ZSh3LCBoKS4KICAgIC8vIFRoaXMgZW5hYmxlcyBhIGZhciBtb3JlIG5hdHVyYWwgcHJvZ3JhbW1pbmcgc3R5bGUgZm9yIHRoZSB3aWRnZXQKICAgIC8vIGF1dGhvciwgd2hvIGNhbiBzdG9yZSBwZXItaW5zdGFuY2Ugc3RhdGUgdXNpbmcgZWl0aGVyIE9PLXN0eWxlCiAgICAvLyBpbnN0YW5jZSBmaWVsZHMgb3IgZnVuY3Rpb25hbC1zdHlsZSBjbG9zdXJlIHZhcmlhYmxlcyAoSSBndWVzcyB0aGlzCiAgICAvLyBpcyBpbiBjb250cmFzdCB0byB3aGF0IGNhbiBvbmx5IGJlIGNhbGxlZCBDLXN0eWxlIHBzZXVkby1PTyB3aGljaCBpcwogICAgLy8gd2hhdCB3ZSByZXF1aXJlZCBiZWZvcmUpLgogICAgaWYgKGRlZmluaXRpb24uZmFjdG9yeSkgewogICAgICBkZWZpbml0aW9uID0gY3JlYXRlTGVnYWN5RGVmaW5pdGlvbkFkYXB0ZXIoZGVmaW5pdGlvbik7CiAgICB9CgogICAgaWYgKCFkZWZpbml0aW9uLnJlbmRlclZhbHVlKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcigiV2lkZ2V0IG11c3QgaGF2ZSBhIHJlbmRlclZhbHVlIGZ1bmN0aW9uIik7CiAgICB9CgogICAgLy8gRm9yIHN0YXRpYyByZW5kZXJpbmcgKG5vbi1TaGlueSksIHVzZSBhIHNpbXBsZSB3aWRnZXQgcmVnaXN0cmF0aW9uCiAgICAvLyBzY2hlbWUuIFdlIGFsc28gdXNlIHRoaXMgc2NoZW1lIGZvciBTaGlueSBhcHBzL2RvY3VtZW50cyB0aGF0IGFsc28KICAgIC8vIGNvbnRhaW4gc3RhdGljIHdpZGdldHMuCiAgICB3aW5kb3cuSFRNTFdpZGdldHMud2lkZ2V0cyA9IHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXRzIHx8IFtdOwogICAgLy8gTWVyZ2UgZGVmYXVsdHMgaW50byB0aGUgZGVmaW5pdGlvbjsgZG9uJ3QgbXV0YXRlIHRoZSBvcmlnaW5hbCBkZWZpbml0aW9uLgogICAgdmFyIHN0YXRpY0JpbmRpbmcgPSBleHRlbmQoe30sIGRlZmF1bHRzLCBkZWZpbml0aW9uKTsKICAgIG92ZXJyaWRlTWV0aG9kKHN0YXRpY0JpbmRpbmcsICJmaW5kIiwgZnVuY3Rpb24oc3VwZXJmdW5jKSB7CiAgICAgIHJldHVybiBmdW5jdGlvbihzY29wZSkgewogICAgICAgIHZhciByZXN1bHRzID0gc3VwZXJmdW5jKHNjb3BlKTsKICAgICAgICAvLyBGaWx0ZXIgb3V0IFNoaW55IG91dHB1dHMsIHdlIG9ubHkgd2FudCB0aGUgc3RhdGljIGtpbmQKICAgICAgICByZXR1cm4gZmlsdGVyQnlDbGFzcyhyZXN1bHRzLCAiaHRtbC13aWRnZXQtb3V0cHV0IiwgZmFsc2UpOwogICAgICB9OwogICAgfSk7CiAgICB3aW5kb3cuSFRNTFdpZGdldHMud2lkZ2V0cy5wdXNoKHN0YXRpY0JpbmRpbmcpOwoKICAgIGlmIChzaGlueU1vZGUpIHsKICAgICAgLy8gU2hpbnkgaXMgcnVubmluZy4gUmVnaXN0ZXIgdGhlIGRlZmluaXRpb24gd2l0aCBhbiBvdXRwdXQgYmluZGluZy4KICAgICAgLy8gVGhlIGRlZmluaXRpb24gaXRzZWxmIHdpbGwgbm90IGJlIHRoZSBvdXRwdXQgYmluZGluZywgaW5zdGVhZAogICAgICAvLyB3ZSB3aWxsIG1ha2UgYW4gb3V0cHV0IGJpbmRpbmcgb2JqZWN0IHRoYXQgZGVsZWdhdGVzIHRvIHRoZQogICAgICAvLyBkZWZpbml0aW9uLiBUaGlzIGlzIGJlY2F1c2Ugd2UgZm9vbGlzaGx5IHVzZWQgdGhlIHNhbWUgbWV0aG9kCiAgICAgIC8vIG5hbWUgKHJlbmRlclZhbHVlKSBmb3IgaHRtbHdpZGdldHMgZGVmaW5pdGlvbiBhbmQgU2hpbnkgYmluZGluZ3MKICAgICAgLy8gYnV0IHRoZXkgYWN0dWFsbHkgaGF2ZSBxdWl0ZSBkaWZmZXJlbnQgc2VtYW50aWNzICh0aGUgU2hpbnkKICAgICAgLy8gYmluZGluZ3MgcmVjZWl2ZSBkYXRhIHRoYXQgaW5jbHVkZXMgbG90cyBvZiBtZXRhZGF0YSB0aGF0IGl0CiAgICAgIC8vIHN0cmlwcyBvZmYgYmVmb3JlIGNhbGxpbmcgaHRtbHdpZGdldHMgcmVuZGVyVmFsdWUpLiBXZSBjYW4ndAogICAgICAvLyBqdXN0IGlnbm9yZSB0aGUgZGlmZmVyZW5jZSBiZWNhdXNlIGluIHNvbWUgd2lkZ2V0cyBpdCdzIGhlbHBmdWwKICAgICAgLy8gdG8gY2FsbCB0aGlzLnJlbmRlclZhbHVlKCkgZnJvbSBpbnNpZGUgb2YgcmVzaXplKCksIGFuZCBpZgogICAgICAvLyB3ZSdyZSBub3QgZGVsZWdhdGluZywgdGhlbiB0aGF0IGNhbGwgd2lsbCBnbyB0byB0aGUgU2hpbnkKICAgICAgLy8gdmVyc2lvbiBpbnN0ZWFkIG9mIHRoZSBodG1sd2lkZ2V0cyB2ZXJzaW9uLgoKICAgICAgLy8gTWVyZ2UgZGVmYXVsdHMgd2l0aCBkZWZpbml0aW9uLCB3aXRob3V0IG11dGF0aW5nIGVpdGhlci4KICAgICAgdmFyIGJpbmRpbmdEZWYgPSBleHRlbmQoe30sIGRlZmF1bHRzLCBkZWZpbml0aW9uKTsKCiAgICAgIC8vIFRoaXMgb2JqZWN0IHdpbGwgYmUgb3VyIGFjdHVhbCBTaGlueSBiaW5kaW5nLgogICAgICB2YXIgc2hpbnlCaW5kaW5nID0gbmV3IFNoaW55Lk91dHB1dEJpbmRpbmcoKTsKCiAgICAgIC8vIFdpdGggYSBmZXcgZXhjZXB0aW9ucywgd2UnbGwgd2FudCB0byBzaW1wbHkgdXNlIHRoZSBiaW5kaW5nRGVmJ3MKICAgICAgLy8gdmVyc2lvbiBvZiBtZXRob2RzIGlmIHRoZXkgYXJlIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGZhbGwgYmFjayB0bwogICAgICAvLyBTaGlueSdzIGRlZmF1bHRzLiBOT1RFOiBJZiBTaGlueSdzIG91dHB1dCBiaW5kaW5ncyBnYWluIGFkZGl0aW9uYWwKICAgICAgLy8gbWV0aG9kcyBpbiB0aGUgZnV0dXJlLCBhbmQgd2Ugd2FudCB0aGVtIHRvIGJlIG92ZXJyaWRlYWJsZSBieQogICAgICAvLyBIVE1MV2lkZ2V0IGJpbmRpbmcgZGVmaW5pdGlvbnMsIHRoZW4gd2UnbGwgbmVlZCB0byBhZGQgdGhlbSB0byB0aGlzCiAgICAgIC8vIGxpc3QuCiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgImdldElkIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgIm9uVmFsdWVDaGFuZ2UiKTsKICAgICAgZGVsZWdhdGVNZXRob2Qoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLCAib25WYWx1ZUVycm9yIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgInJlbmRlckVycm9yIik7CiAgICAgIGRlbGVnYXRlTWV0aG9kKHNoaW55QmluZGluZywgYmluZGluZ0RlZiwgImNsZWFyRXJyb3IiKTsKICAgICAgZGVsZWdhdGVNZXRob2Qoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLCAic2hvd1Byb2dyZXNzIik7CgogICAgICAvLyBUaGUgZmluZCwgcmVuZGVyVmFsdWUsIGFuZCByZXNpemUgYXJlIGhhbmRsZWQgZGlmZmVyZW50bHksIGJlY2F1c2Ugd2UKICAgICAgLy8gd2FudCB0byBhY3R1YWxseSBkZWNvcmF0ZSB0aGUgYmVoYXZpb3Igb2YgdGhlIGJpbmRpbmdEZWYgbWV0aG9kcy4KCiAgICAgIHNoaW55QmluZGluZy5maW5kID0gZnVuY3Rpb24oc2NvcGUpIHsKICAgICAgICB2YXIgcmVzdWx0cyA9IGJpbmRpbmdEZWYuZmluZChzY29wZSk7CgogICAgICAgIC8vIE9ubHkgcmV0dXJuIGVsZW1lbnRzIHRoYXQgYXJlIFNoaW55IG91dHB1dHMsIG5vdCBzdGF0aWMgb25lcwogICAgICAgIHZhciBkeW5hbWljUmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKCIuaHRtbC13aWRnZXQtb3V0cHV0Iik7CgogICAgICAgIC8vIEl0J3MgcG9zc2libGUgdGhhdCB3aGF0ZXZlciBjYXVzZWQgU2hpbnkgdG8gdGhpbmsgdGhlcmUgbWlnaHQgYmUKICAgICAgICAvLyBuZXcgZHluYW1pYyBvdXRwdXRzLCBhbHNvIGNhdXNlZCB0aGVyZSB0byBiZSBuZXcgc3RhdGljIG91dHB1dHMuCiAgICAgICAgLy8gU2luY2UgdGhlcmUgbWlnaHQgYmUgbG90cyBvZiBkaWZmZXJlbnQgaHRtbHdpZGdldHMgYmluZGluZ3MsIHdlCiAgICAgICAgLy8gc2NoZWR1bGUgZXhlY3V0aW9uIGZvciBsYXRlci0tbm8gbmVlZCB0byBzdGF0aWNSZW5kZXIgbXVsdGlwbGUKICAgICAgICAvLyB0aW1lcy4KICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggIT09IGR5bmFtaWNSZXN1bHRzLmxlbmd0aCkKICAgICAgICAgIHNjaGVkdWxlU3RhdGljUmVuZGVyKCk7CgogICAgICAgIHJldHVybiBkeW5hbWljUmVzdWx0czsKICAgICAgfTsKCiAgICAgIC8vIFdyYXAgcmVuZGVyVmFsdWUgdG8gaGFuZGxlIGluaXRpYWxpemF0aW9uLCB3aGljaCB1bmZvcnR1bmF0ZWx5IGlzbid0CiAgICAgIC8vIHN1cHBvcnRlZCBuYXRpdmVseSBieSBTaGlueSBhdCB0aGUgdGltZSBvZiB0aGlzIHdyaXRpbmcuCgogICAgICBzaGlueUJpbmRpbmcucmVuZGVyVmFsdWUgPSBmdW5jdGlvbihlbCwgZGF0YSkgewogICAgICAgIFNoaW55LnJlbmRlckRlcGVuZGVuY2llcyhkYXRhLmRlcHMpOwogICAgICAgIC8vIFJlc29sdmUgc3RyaW5ncyBtYXJrZWQgYXMgamF2YXNjcmlwdCBsaXRlcmFscyB0byBvYmplY3RzCiAgICAgICAgaWYgKCEoZGF0YS5ldmFscyBpbnN0YW5jZW9mIEFycmF5KSkgZGF0YS5ldmFscyA9IFtkYXRhLmV2YWxzXTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgZGF0YS5ldmFscyAmJiBpIDwgZGF0YS5ldmFscy5sZW5ndGg7IGkrKykgewogICAgICAgICAgd2luZG93LkhUTUxXaWRnZXRzLmV2YWx1YXRlU3RyaW5nTWVtYmVyKGRhdGEueCwgZGF0YS5ldmFsc1tpXSk7CiAgICAgICAgfQogICAgICAgIGlmICghYmluZGluZ0RlZi5yZW5kZXJPbk51bGxWYWx1ZSkgewogICAgICAgICAgaWYgKGRhdGEueCA9PT0gbnVsbCkgewogICAgICAgICAgICBlbC5zdHlsZS52aXNpYmlsaXR5ID0gImhpZGRlbiI7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGVsLnN0eWxlLnZpc2liaWxpdHkgPSAiaW5oZXJpdCI7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghZWxlbWVudERhdGEoZWwsICJpbml0aWFsaXplZCIpKSB7CiAgICAgICAgICBpbml0U2l6aW5nKGVsKTsKCiAgICAgICAgICBlbGVtZW50RGF0YShlbCwgImluaXRpYWxpemVkIiwgdHJ1ZSk7CiAgICAgICAgICBpZiAoYmluZGluZ0RlZi5pbml0aWFsaXplKSB7CiAgICAgICAgICAgIHZhciByZXN1bHQgPSBiaW5kaW5nRGVmLmluaXRpYWxpemUoZWwsIGVsLm9mZnNldFdpZHRoLAogICAgICAgICAgICAgIGVsLm9mZnNldEhlaWdodCk7CiAgICAgICAgICAgIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiLCByZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBiaW5kaW5nRGVmLnJlbmRlclZhbHVlKGVsLCBkYXRhLngsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgZXZhbEFuZFJ1bihkYXRhLmpzSG9va3MucmVuZGVyLCBlbGVtZW50RGF0YShlbCwgImluaXRfcmVzdWx0IiksIFtlbCwgZGF0YS54XSk7CiAgICAgIH07CgogICAgICAvLyBPbmx5IG92ZXJyaWRlIHJlc2l6ZSBpZiBiaW5kaW5nRGVmIGltcGxlbWVudHMgaXQKICAgICAgaWYgKGJpbmRpbmdEZWYucmVzaXplKSB7CiAgICAgICAgc2hpbnlCaW5kaW5nLnJlc2l6ZSA9IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgICAvLyBTaGlueSBjYW4gY2FsbCByZXNpemUgYmVmb3JlIGluaXRpYWxpemUvcmVuZGVyVmFsdWUgaGF2ZSBiZWVuCiAgICAgICAgICAvLyBjYWxsZWQsIHdoaWNoIGRvZXNuJ3QgbWFrZSBzZW5zZSBmb3Igd2lkZ2V0cy4KICAgICAgICAgIGlmIChlbGVtZW50RGF0YShlbCwgImluaXRpYWxpemVkIikpIHsKICAgICAgICAgICAgYmluZGluZ0RlZi5yZXNpemUoZWwsIHdpZHRoLCBoZWlnaHQsIGVsZW1lbnREYXRhKGVsLCAiaW5pdF9yZXN1bHQiKSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfQoKICAgICAgU2hpbnkub3V0cHV0QmluZGluZ3MucmVnaXN0ZXIoc2hpbnlCaW5kaW5nLCBiaW5kaW5nRGVmLm5hbWUpOwogICAgfQogIH07CgogIHZhciBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogIGZ1bmN0aW9uIHNjaGVkdWxlU3RhdGljUmVuZGVyKCkgewogICAgaWYgKCFzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQpIHsKICAgICAgc2NoZWR1bGVTdGF0aWNSZW5kZXJUaW1lcklkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICBzY2hlZHVsZVN0YXRpY1JlbmRlclRpbWVySWQgPSBudWxsOwogICAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgICAgfSwgMSk7CiAgICB9CiAgfQoKICAvLyBSZW5kZXIgc3RhdGljIHdpZGdldHMgYWZ0ZXIgdGhlIGRvY3VtZW50IGZpbmlzaGVzIGxvYWRpbmcKICAvLyBTdGF0aWNhbGx5IHJlbmRlciBhbGwgZWxlbWVudHMgdGhhdCBhcmUgb2YgdGhpcyB3aWRnZXQncyBjbGFzcwogIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIgPSBmdW5jdGlvbigpIHsKICAgIHZhciBiaW5kaW5ncyA9IHdpbmRvdy5IVE1MV2lkZ2V0cy53aWRnZXRzIHx8IFtdOwogICAgZm9yRWFjaChiaW5kaW5ncywgZnVuY3Rpb24oYmluZGluZykgewogICAgICB2YXIgbWF0Y2hlcyA9IGJpbmRpbmcuZmluZChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpOwogICAgICBmb3JFYWNoKG1hdGNoZXMsIGZ1bmN0aW9uKGVsKSB7CiAgICAgICAgdmFyIHNpemVPYmogPSBpbml0U2l6aW5nKGVsLCBiaW5kaW5nKTsKCiAgICAgICAgaWYgKGhhc0NsYXNzKGVsLCAiaHRtbC13aWRnZXQtc3RhdGljLWJvdW5kIikpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgZWwuY2xhc3NOYW1lID0gZWwuY2xhc3NOYW1lICsgIiBodG1sLXdpZGdldC1zdGF0aWMtYm91bmQiOwoKICAgICAgICB2YXIgaW5pdFJlc3VsdDsKICAgICAgICBpZiAoYmluZGluZy5pbml0aWFsaXplKSB7CiAgICAgICAgICBpbml0UmVzdWx0ID0gYmluZGluZy5pbml0aWFsaXplKGVsLAogICAgICAgICAgICBzaXplT2JqID8gc2l6ZU9iai5nZXRXaWR0aCgpIDogZWwub2Zmc2V0V2lkdGgsCiAgICAgICAgICAgIHNpemVPYmogPyBzaXplT2JqLmdldEhlaWdodCgpIDogZWwub2Zmc2V0SGVpZ2h0CiAgICAgICAgICApOwogICAgICAgICAgZWxlbWVudERhdGEoZWwsICJpbml0X3Jlc3VsdCIsIGluaXRSZXN1bHQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGJpbmRpbmcucmVzaXplKSB7CiAgICAgICAgICB2YXIgbGFzdFNpemUgPSB7CiAgICAgICAgICAgIHc6IHNpemVPYmogPyBzaXplT2JqLmdldFdpZHRoKCkgOiBlbC5vZmZzZXRXaWR0aCwKICAgICAgICAgICAgaDogc2l6ZU9iaiA/IHNpemVPYmouZ2V0SGVpZ2h0KCkgOiBlbC5vZmZzZXRIZWlnaHQKICAgICAgICAgIH07CiAgICAgICAgICB2YXIgcmVzaXplSGFuZGxlciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIHNpemUgPSB7CiAgICAgICAgICAgICAgdzogc2l6ZU9iaiA/IHNpemVPYmouZ2V0V2lkdGgoKSA6IGVsLm9mZnNldFdpZHRoLAogICAgICAgICAgICAgIGg6IHNpemVPYmogPyBzaXplT2JqLmdldEhlaWdodCgpIDogZWwub2Zmc2V0SGVpZ2h0CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmIChzaXplLncgPT09IDAgJiYgc2l6ZS5oID09PSAwKQogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgaWYgKHNpemUudyA9PT0gbGFzdFNpemUudyAmJiBzaXplLmggPT09IGxhc3RTaXplLmgpCiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICBsYXN0U2l6ZSA9IHNpemU7CiAgICAgICAgICAgIGJpbmRpbmcucmVzaXplKGVsLCBzaXplLncsIHNpemUuaCwgaW5pdFJlc3VsdCk7CiAgICAgICAgICB9OwoKICAgICAgICAgIG9uKHdpbmRvdywgInJlc2l6ZSIsIHJlc2l6ZUhhbmRsZXIpOwoKICAgICAgICAgIC8vIFRoaXMgaXMgbmVlZGVkIGZvciBjYXNlcyB3aGVyZSB3ZSdyZSBydW5uaW5nIGluIGEgU2hpbnkKICAgICAgICAgIC8vIGFwcCwgYnV0IHRoZSB3aWRnZXQgaXRzZWxmIGlzIG5vdCBhIFNoaW55IG91dHB1dCwgYnV0CiAgICAgICAgICAvLyByYXRoZXIgYSBzaW1wbGUgc3RhdGljIHdpZGdldC4gT25lIGV4YW1wbGUgb2YgdGhpcyBpcwogICAgICAgICAgLy8gYW4gcm1hcmtkb3duIGRvY3VtZW50IHRoYXQgaGFzIHJ1bnRpbWU6c2hpbnkgYW5kIHdpZGdldAogICAgICAgICAgLy8gdGhhdCBpc24ndCBpbiBhIHJlbmRlciBmdW5jdGlvbi4gU2hpbnkgb25seSBrbm93cyB0bwogICAgICAgICAgLy8gY2FsbCByZXNpemUgaGFuZGxlcnMgZm9yIFNoaW55IG91dHB1dHMsIG5vdCBmb3Igc3RhdGljCiAgICAgICAgICAvLyB3aWRnZXRzLCBzbyB3ZSBkbyBpdCBvdXJzZWx2ZXMuCiAgICAgICAgICBpZiAod2luZG93LmpRdWVyeSkgewogICAgICAgICAgICB3aW5kb3cualF1ZXJ5KGRvY3VtZW50KS5vbigKICAgICAgICAgICAgICAic2hvd24uaHRtbHdpZGdldHMgc2hvd24uYnMudGFiLmh0bWx3aWRnZXRzIHNob3duLmJzLmNvbGxhcHNlLmh0bWx3aWRnZXRzIiwKICAgICAgICAgICAgICByZXNpemVIYW5kbGVyCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHdpbmRvdy5qUXVlcnkoZG9jdW1lbnQpLm9uKAogICAgICAgICAgICAgICJoaWRkZW4uaHRtbHdpZGdldHMgaGlkZGVuLmJzLnRhYi5odG1sd2lkZ2V0cyBoaWRkZW4uYnMuY29sbGFwc2UuaHRtbHdpZGdldHMiLAogICAgICAgICAgICAgIHJlc2l6ZUhhbmRsZXIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBUaGlzIGlzIG5lZWRlZCBmb3IgdGhlIHNwZWNpZmljIGNhc2Ugb2YgaW9zbGlkZXMsIHdoaWNoCiAgICAgICAgICAvLyBmbGlwcyBzbGlkZXMgYmV0d2VlbiBkaXNwbGF5Om5vbmUgYW5kIGRpc3BsYXk6YmxvY2suCiAgICAgICAgICAvLyBJZGVhbGx5IHdlIHdvdWxkIG5vdCBoYXZlIHRvIGhhdmUgaW9zbGlkZS1zcGVjaWZpYyBjb2RlCiAgICAgICAgICAvLyBoZXJlLCBidXQgcmF0aGVyIGhhdmUgaW9zbGlkZXMgcmFpc2UgYSBnZW5lcmljIGV2ZW50LAogICAgICAgICAgLy8gYnV0IHRoZSBybWFya2Rvd24gcGFja2FnZSBqdXN0IHdlbnQgdG8gQ1JBTiBzbyB0aGUKICAgICAgICAgIC8vIHdpbmRvdyB0byBnZXR0aW5nIHRoYXQgZml4ZWQgbWF5IGJlIGxvbmcuCiAgICAgICAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHsKICAgICAgICAgICAgLy8gSXQncyBPSyB0byBsaW1pdCB0aGlzIHRvIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyCiAgICAgICAgICAgIC8vIGJyb3dzZXJzIGJlY2F1c2UgaW9zbGlkZXMgaXRzZWxmIG9ubHkgc3VwcG9ydHMKICAgICAgICAgICAgLy8gc3VjaCBicm93c2Vycy4KICAgICAgICAgICAgb24oZG9jdW1lbnQsICJzbGlkZWVudGVyIiwgcmVzaXplSGFuZGxlcik7CiAgICAgICAgICAgIG9uKGRvY3VtZW50LCAic2xpZGVsZWF2ZSIsIHJlc2l6ZUhhbmRsZXIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdmFyIHNjcmlwdERhdGEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJzY3JpcHRbZGF0YS1mb3I9JyIgKyBlbC5pZCArICInXVt0eXBlPSdhcHBsaWNhdGlvbi9qc29uJ10iKTsKICAgICAgICBpZiAoc2NyaXB0RGF0YSkgewogICAgICAgICAgdmFyIGRhdGEgPSBKU09OLnBhcnNlKHNjcmlwdERhdGEudGV4dENvbnRlbnQgfHwgc2NyaXB0RGF0YS50ZXh0KTsKICAgICAgICAgIC8vIFJlc29sdmUgc3RyaW5ncyBtYXJrZWQgYXMgamF2YXNjcmlwdCBsaXRlcmFscyB0byBvYmplY3RzCiAgICAgICAgICBpZiAoIShkYXRhLmV2YWxzIGluc3RhbmNlb2YgQXJyYXkpKSBkYXRhLmV2YWxzID0gW2RhdGEuZXZhbHNdOwogICAgICAgICAgZm9yICh2YXIgayA9IDA7IGRhdGEuZXZhbHMgJiYgayA8IGRhdGEuZXZhbHMubGVuZ3RoOyBrKyspIHsKICAgICAgICAgICAgd2luZG93LkhUTUxXaWRnZXRzLmV2YWx1YXRlU3RyaW5nTWVtYmVyKGRhdGEueCwgZGF0YS5ldmFsc1trXSk7CiAgICAgICAgICB9CiAgICAgICAgICBiaW5kaW5nLnJlbmRlclZhbHVlKGVsLCBkYXRhLngsIGluaXRSZXN1bHQpOwogICAgICAgICAgZXZhbEFuZFJ1bihkYXRhLmpzSG9va3MucmVuZGVyLCBpbml0UmVzdWx0LCBbZWwsIGRhdGEueF0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKCiAgICBpbnZva2VQb3N0UmVuZGVySGFuZGxlcnMoKTsKICB9CgogIC8vIFdhaXQgdW50aWwgYWZ0ZXIgdGhlIGRvY3VtZW50IGhhcyBsb2FkZWQgdG8gcmVuZGVyIHRoZSB3aWRnZXRzLgogIGlmIChkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgZnVuY3Rpb24oKSB7CiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBhcmd1bWVudHMuY2FsbGVlLCBmYWxzZSk7CiAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgIH0sIGZhbHNlKTsKICB9IGVsc2UgaWYgKGRvY3VtZW50LmF0dGFjaEV2ZW50KSB7CiAgICBkb2N1bWVudC5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIiwgZnVuY3Rpb24oKSB7CiAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiKSB7CiAgICAgICAgZG9jdW1lbnQuZGV0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsIGFyZ3VtZW50cy5jYWxsZWUpOwogICAgICAgIHdpbmRvdy5IVE1MV2lkZ2V0cy5zdGF0aWNSZW5kZXIoKTsKICAgICAgfQogICAgfSk7CiAgfQoKCiAgd2luZG93LkhUTUxXaWRnZXRzLmdldEF0dGFjaG1lbnRVcmwgPSBmdW5jdGlvbihkZXBuYW1lLCBrZXkpIHsKICAgIC8vIElmIG5vIGtleSwgZGVmYXVsdCB0byB0aGUgZmlyc3QgaXRlbQogICAgaWYgKHR5cGVvZihrZXkpID09PSAidW5kZWZpbmVkIikKICAgICAga2V5ID0gMTsKCiAgICB2YXIgbGluayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRlcG5hbWUgKyAiLSIgKyBrZXkgKyAiLWF0dGFjaG1lbnQiKTsKICAgIGlmICghbGluaykgewogICAgICB0aHJvdyBuZXcgRXJyb3IoIkF0dGFjaG1lbnQgIiArIGRlcG5hbWUgKyAiLyIgKyBrZXkgKyAiIG5vdCBmb3VuZCBpbiBkb2N1bWVudCIpOwogICAgfQogICAgcmV0dXJuIGxpbmsuZ2V0QXR0cmlidXRlKCJocmVmIik7CiAgfTsKCiAgd2luZG93LkhUTUxXaWRnZXRzLmRhdGFmcmFtZVRvRDMgPSBmdW5jdGlvbihkZikgewogICAgdmFyIG5hbWVzID0gW107CiAgICB2YXIgbGVuZ3RoOwogICAgZm9yICh2YXIgbmFtZSBpbiBkZikgewogICAgICAgIGlmIChkZi5oYXNPd25Qcm9wZXJ0eShuYW1lKSkKICAgICAgICAgICAgbmFtZXMucHVzaChuYW1lKTsKICAgICAgICBpZiAodHlwZW9mKGRmW25hbWVdKSAhPT0gIm9iamVjdCIgfHwgdHlwZW9mKGRmW25hbWVdLmxlbmd0aCkgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWxsIGZpZWxkcyBtdXN0IGJlIGFycmF5cyIpOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mKGxlbmd0aCkgIT09ICJ1bmRlZmluZWQiICYmIGxlbmd0aCAhPT0gZGZbbmFtZV0ubGVuZ3RoKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQWxsIGZpZWxkcyBtdXN0IGJlIGFycmF5cyBvZiB0aGUgc2FtZSBsZW5ndGgiKTsKICAgICAgICB9CiAgICAgICAgbGVuZ3RoID0gZGZbbmFtZV0ubGVuZ3RoOwogICAgfQogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIHZhciBpdGVtOwogICAgZm9yICh2YXIgcm93ID0gMDsgcm93IDwgbGVuZ3RoOyByb3crKykgewogICAgICAgIGl0ZW0gPSB7fTsKICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCBuYW1lcy5sZW5ndGg7IGNvbCsrKSB7CiAgICAgICAgICAgIGl0ZW1bbmFtZXNbY29sXV0gPSBkZltuYW1lc1tjb2xdXVtyb3ddOwogICAgICAgIH0KICAgICAgICByZXN1bHRzLnB1c2goaXRlbSk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICB3aW5kb3cuSFRNTFdpZGdldHMudHJhbnNwb3NlQXJyYXkyRCA9IGZ1bmN0aW9uKGFycmF5KSB7CiAgICAgIGlmIChhcnJheS5sZW5ndGggPT09IDApIHJldHVybiBhcnJheTsKICAgICAgdmFyIG5ld0FycmF5ID0gYXJyYXlbMF0ubWFwKGZ1bmN0aW9uKGNvbCwgaSkgewogICAgICAgICAgcmV0dXJuIGFycmF5Lm1hcChmdW5jdGlvbihyb3cpIHsKICAgICAgICAgICAgICByZXR1cm4gcm93W2ldCiAgICAgICAgICB9KQogICAgICB9KTsKICAgICAgcmV0dXJuIG5ld0FycmF5OwogIH07CiAgLy8gU3BsaXQgdmFsdWUgYXQgc3BsaXRDaGFyLCBidXQgYWxsb3cgc3BsaXRDaGFyIHRvIGJlIGVzY2FwZWQKICAvLyB1c2luZyBlc2NhcGVDaGFyLiBBbnkgb3RoZXIgY2hhcmFjdGVycyBlc2NhcGVkIGJ5IGVzY2FwZUNoYXIKICAvLyB3aWxsIGJlIGluY2x1ZGVkIGFzIHVzdWFsIChpbmNsdWRpbmcgZXNjYXBlQ2hhciBpdHNlbGYpLgogIGZ1bmN0aW9uIHNwbGl0V2l0aEVzY2FwZSh2YWx1ZSwgc3BsaXRDaGFyLCBlc2NhcGVDaGFyKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgdmFyIGVzY2FwZU1vZGUgPSBmYWxzZTsKICAgIHZhciBjdXJyZW50UmVzdWx0ID0gIiI7CiAgICBmb3IgKHZhciBwb3MgPSAwOyBwb3MgPCB2YWx1ZS5sZW5ndGg7IHBvcysrKSB7CiAgICAgIGlmICghZXNjYXBlTW9kZSkgewogICAgICAgIGlmICh2YWx1ZVtwb3NdID09PSBzcGxpdENoYXIpIHsKICAgICAgICAgIHJlc3VsdHMucHVzaChjdXJyZW50UmVzdWx0KTsKICAgICAgICAgIGN1cnJlbnRSZXN1bHQgPSAiIjsKICAgICAgICB9IGVsc2UgaWYgKHZhbHVlW3Bvc10gPT09IGVzY2FwZUNoYXIpIHsKICAgICAgICAgIGVzY2FwZU1vZGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXJyZW50UmVzdWx0ICs9IHZhbHVlW3Bvc107CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGN1cnJlbnRSZXN1bHQgKz0gdmFsdWVbcG9zXTsKICAgICAgICBlc2NhcGVNb2RlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICAgIGlmIChjdXJyZW50UmVzdWx0ICE9PSAiIikgewogICAgICByZXN1bHRzLnB1c2goY3VycmVudFJlc3VsdCk7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0czsKICB9CiAgLy8gRnVuY3Rpb24gYXV0aG9yZWQgYnkgWWlodWkvSkogQWxsYWlyZQogIHdpbmRvdy5IVE1MV2lkZ2V0cy5ldmFsdWF0ZVN0cmluZ01lbWJlciA9IGZ1bmN0aW9uKG8sIG1lbWJlcikgewogICAgdmFyIHBhcnRzID0gc3BsaXRXaXRoRXNjYXBlKG1lbWJlciwgJy4nLCAnXFwnKTsKICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGFydHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgIHZhciBwYXJ0ID0gcGFydHNbaV07CiAgICAgIC8vIHBhcnQgbWF5IGJlIGEgY2hhcmFjdGVyIG9yICdudW1lcmljJyBtZW1iZXIgbmFtZQogICAgICBpZiAobyAhPT0gbnVsbCAmJiB0eXBlb2YgbyA9PT0gIm9iamVjdCIgJiYgcGFydCBpbiBvKSB7CiAgICAgICAgaWYgKGkgPT0gKGwgLSAxKSkgeyAvLyBpZiB3ZSBhcmUgYXQgdGhlIGVuZCBvZiB0aGUgbGluZSB0aGVuIGV2YWx1bGF0ZQogICAgICAgICAgaWYgKHR5cGVvZiBvW3BhcnRdID09PSAic3RyaW5nIikKICAgICAgICAgICAgb1twYXJ0XSA9IGV2YWwoIigiICsgb1twYXJ0XSArICIpIik7CiAgICAgICAgfSBlbHNlIHsgLy8gb3RoZXJ3aXNlIGNvbnRpbnVlIHRvIG5leHQgZW1iZWRkZWQgb2JqZWN0CiAgICAgICAgICBvID0gb1twYXJ0XTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBSZXRyaWV2ZSB0aGUgSFRNTFdpZGdldCBpbnN0YW5jZSAoaS5lLiB0aGUgcmV0dXJuIHZhbHVlIG9mIGFuCiAgLy8gSFRNTFdpZGdldCBiaW5kaW5nJ3MgaW5pdGlhbGl6ZSgpIG9yIGZhY3RvcnkoKSBmdW5jdGlvbikKICAvLyBhc3NvY2lhdGVkIHdpdGggYW4gZWxlbWVudCwgb3IgbnVsbCBpZiBub25lLgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKGVsKSB7CiAgICByZXR1cm4gZWxlbWVudERhdGEoZWwsICJpbml0X3Jlc3VsdCIpOwogIH07CgogIC8vIEZpbmRzIHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBzY29wZSB0aGF0IG1hdGNoZXMgdGhlIHNlbGVjdG9yLAogIC8vIGFuZCByZXR1cm5zIHRoZSBIVE1MV2lkZ2V0IGluc3RhbmNlIChpLmUuIHRoZSByZXR1cm4gdmFsdWUgb2YKICAvLyBhbiBIVE1MV2lkZ2V0IGJpbmRpbmcncyBpbml0aWFsaXplKCkgb3IgZmFjdG9yeSgpIGZ1bmN0aW9uKQogIC8vIGFzc29jaWF0ZWQgd2l0aCB0aGF0IGVsZW1lbnQsIGlmIGFueS4gSWYgbm8gZWxlbWVudCBtYXRjaGVzIHRoZQogIC8vIHNlbGVjdG9yLCBvciB0aGUgZmlyc3QgbWF0Y2hpbmcgZWxlbWVudCBoYXMgbm8gSFRNTFdpZGdldAogIC8vIGluc3RhbmNlIGFzc29jaWF0ZWQgd2l0aCBpdCwgdGhlbiBudWxsIGlzIHJldHVybmVkLgogIC8vCiAgLy8gVGhlIHNjb3BlIGFyZ3VtZW50IGlzIG9wdGlvbmFsLCBhbmQgZGVmYXVsdHMgdG8gd2luZG93LmRvY3VtZW50LgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5maW5kID0gZnVuY3Rpb24oc2NvcGUsIHNlbGVjdG9yKSB7CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7CiAgICAgIHNlbGVjdG9yID0gc2NvcGU7CiAgICAgIHNjb3BlID0gZG9jdW1lbnQ7CiAgICB9CgogICAgdmFyIGVsID0gc2NvcGUucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7CiAgICBpZiAoZWwgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd2luZG93LkhUTUxXaWRnZXRzLmdldEluc3RhbmNlKGVsKTsKICAgIH0KICB9OwoKICAvLyBGaW5kcyBhbGwgZWxlbWVudHMgaW4gdGhlIHNjb3BlIHRoYXQgbWF0Y2ggdGhlIHNlbGVjdG9yLCBhbmQKICAvLyByZXR1cm5zIHRoZSBIVE1MV2lkZ2V0IGluc3RhbmNlcyAoaS5lLiB0aGUgcmV0dXJuIHZhbHVlcyBvZgogIC8vIGFuIEhUTUxXaWRnZXQgYmluZGluZydzIGluaXRpYWxpemUoKSBvciBmYWN0b3J5KCkgZnVuY3Rpb24pCiAgLy8gYXNzb2NpYXRlZCB3aXRoIHRoZSBlbGVtZW50cywgaW4gYW4gYXJyYXkuIElmIGVsZW1lbnRzIHRoYXQKICAvLyBtYXRjaCB0aGUgc2VsZWN0b3IgZG9uJ3QgaGF2ZSBhbiBhc3NvY2lhdGVkIEhUTUxXaWRnZXQKICAvLyBpbnN0YW5jZSwgdGhlIHJldHVybmVkIGFycmF5IHdpbGwgY29udGFpbiBudWxscy4KICAvLwogIC8vIFRoZSBzY29wZSBhcmd1bWVudCBpcyBvcHRpb25hbCwgYW5kIGRlZmF1bHRzIHRvIHdpbmRvdy5kb2N1bWVudC4KICB3aW5kb3cuSFRNTFdpZGdldHMuZmluZEFsbCA9IGZ1bmN0aW9uKHNjb3BlLCBzZWxlY3RvcikgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkgewogICAgICBzZWxlY3RvciA9IHNjb3BlOwogICAgICBzY29wZSA9IGRvY3VtZW50OwogICAgfQoKICAgIHZhciBub2RlcyA9IHNjb3BlLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpOwogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHsKICAgICAgcmVzdWx0cy5wdXNoKHdpbmRvdy5IVE1MV2lkZ2V0cy5nZXRJbnN0YW5jZShub2Rlc1tpXSkpOwogICAgfQogICAgcmV0dXJuIHJlc3VsdHM7CiAgfTsKCiAgdmFyIHBvc3RSZW5kZXJIYW5kbGVycyA9IFtdOwogIGZ1bmN0aW9uIGludm9rZVBvc3RSZW5kZXJIYW5kbGVycygpIHsKICAgIHdoaWxlIChwb3N0UmVuZGVySGFuZGxlcnMubGVuZ3RoKSB7CiAgICAgIHZhciBoYW5kbGVyID0gcG9zdFJlbmRlckhhbmRsZXJzLnNoaWZ0KCk7CiAgICAgIGlmIChoYW5kbGVyKSB7CiAgICAgICAgaGFuZGxlcigpOwogICAgICB9CiAgICB9CiAgfQoKICAvLyBSZWdpc3RlciB0aGUgZ2l2ZW4gY2FsbGJhY2sgZnVuY3Rpb24gdG8gYmUgaW52b2tlZCBhZnRlciB0aGUKICAvLyBuZXh0IHRpbWUgc3RhdGljIHdpZGdldHMgYXJlIHJlbmRlcmVkLgogIHdpbmRvdy5IVE1MV2lkZ2V0cy5hZGRQb3N0UmVuZGVySGFuZGxlciA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7CiAgICBwb3N0UmVuZGVySGFuZGxlcnMucHVzaChjYWxsYmFjayk7CiAgfTsKCiAgLy8gVGFrZXMgYSBuZXctc3R5bGUgaW5zdGFuY2UtYm91bmQgZGVmaW5pdGlvbiwgYW5kIHJldHVybnMgYW4KICAvLyBvbGQtc3R5bGUgY2xhc3MtYm91bmQgZGVmaW5pdGlvbi4gVGhpcyBzYXZlcyB1cyBmcm9tIGhhdmluZwogIC8vIHRvIHJld3JpdGUgYWxsIHRoZSBsb2dpYyBpbiB0aGlzIGZpbGUgdG8gYWNjb21vZGF0ZSBib3RoCiAgLy8gdHlwZXMgb2YgZGVmaW5pdGlvbnMuCiAgZnVuY3Rpb24gY3JlYXRlTGVnYWN5RGVmaW5pdGlvbkFkYXB0ZXIoZGVmbikgewogICAgdmFyIHJlc3VsdCA9IHsKICAgICAgbmFtZTogZGVmbi5uYW1lLAogICAgICB0eXBlOiBkZWZuLnR5cGUsCiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7CiAgICAgICAgcmV0dXJuIGRlZm4uZmFjdG9yeShlbCwgd2lkdGgsIGhlaWdodCk7CiAgICAgIH0sCiAgICAgIHJlbmRlclZhbHVlOiBmdW5jdGlvbihlbCwgeCwgaW5zdGFuY2UpIHsKICAgICAgICByZXR1cm4gaW5zdGFuY2UucmVuZGVyVmFsdWUoeCk7CiAgICAgIH0sCiAgICAgIHJlc2l6ZTogZnVuY3Rpb24oZWwsIHdpZHRoLCBoZWlnaHQsIGluc3RhbmNlKSB7CiAgICAgICAgcmV0dXJuIGluc3RhbmNlLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KTsKICAgICAgfQogICAgfTsKCiAgICBpZiAoZGVmbi5maW5kKQogICAgICByZXN1bHQuZmluZCA9IGRlZm4uZmluZDsKICAgIGlmIChkZWZuLnJlbmRlckVycm9yKQogICAgICByZXN1bHQucmVuZGVyRXJyb3IgPSBkZWZuLnJlbmRlckVycm9yOwogICAgaWYgKGRlZm4uY2xlYXJFcnJvcikKICAgICAgcmVzdWx0LmNsZWFyRXJyb3IgPSBkZWZuLmNsZWFyRXJyb3I7CgogICAgcmV0dXJuIHJlc3VsdDsKICB9Cn0pKCk7Cgo="></script>
<script src="data:application/x-javascript;base64,SFRNTFdpZGdldHMud2lkZ2V0KHsNCg0KICBuYW1lOiAicGl2b3R0YWJsZXIiLA0KDQogIHR5cGU6ICJvdXRwdXQiLA0KDQogIGZhY3Rvcnk6IGZ1bmN0aW9uKGVsLCB3aWR0aCwgaGVpZ2h0KSB7DQoNCiAgICB2YXIgcGl2b3RFbGVtZW50ID0gZWw7DQogICAgdmFyIGluaXRpYWxpc2VkID0gZmFsc2U7DQoNCiAgICByZXR1cm4gew0KICAgICAgcmVuZGVyVmFsdWU6IGZ1bmN0aW9uKHdpZGdldERhdGEpIHsNCg0KICAgICAgICBpZighaW5pdGlhbGlzZWQpIHsNCiAgICAgICAgICBpZih3aWRnZXREYXRhLnRhYmxlQ3NzICE9PSBudWxsKSB7DQogICAgICAgICAgICBkb2NIZWFkID0gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpWzBdOw0KICAgICAgICAgICAgdmFyIHN0eWxlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7DQogICAgICAgICAgICBzdHlsZXMuaW5uZXJIVE1MID0gd2lkZ2V0RGF0YS50YWJsZUNzczsNCiAgICAgICAgICAgIGRvY0hlYWQuYXBwZW5kQ2hpbGQoc3R5bGVzKTsNCiAgICAgICAgICB9DQogICAgICAgICAgaW5pdGlhbGlzZWQgPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIHBpdm90RWxlbWVudC5pbm5lckhUTUwgPSB3aWRnZXREYXRhLnRhYmxlSHRtbDsNCiAgICAgIH0sDQoNCiAgICAgIHJlc2l6ZTogZnVuY3Rpb24od2lkdGgsIGhlaWdodCkgew0KICAgICAgfSwNCg0KICAgIH07DQogIH0NCn0pOw0K"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore"><ol style="list-style-type: decimal">
<li>Introduction</li>
</ol></h1>
<h4 class="author">Chris Bailiss</h4>
<h4 class="date">2019-08-05</h4>



<div id="in-this-vignette" class="section level2">
<h2>In This Vignette</h2>
<ul>
<li>Introducing pivottabler</li>
<li>Pivot Tables
<ul>
<li>Quick Example</li>
<li>Definition</li>
<li>In reality</li>
</ul></li>
<li>Sample Data</li>
<li>Basic Pivot Table</li>
<li>Constructing the Basic Pivot Table</li>
<li>Outputting the Pivot Table as Plain Text</li>
<li>Extending the Basic Pivot Table</li>
<li>Quick-Pivot Functions</li>
<li>Examples Gallery</li>
<li>Further Reading</li>
</ul>
</div>
<div id="introducing-pivottabler" class="section level2">
<h2>Introducing pivottabler</h2>
<p>The <code>pivottabler</code> package enables pivot tables to be created and rendered/exported with just a few lines of R.</p>
<p>Pivot tables are constructed natively in R, either via a short one line command to build a basic pivot table or via series of R commands that gradually build a more bespoke pivot table to meet your needs.</p>
<p>The <code>pivottabler</code> package:</p>
<ul>
<li>provides a simple framework for specifying and aggregating data, based on either the dplyr package or the data.table package.<br />
</li>
<li>provides optional hooks for specifying custom calculations/aggregations for more complex scenarios
<ul>
<li>This allows a wide-range of R functions, including custom functions written in R, to be used in the calculation logic.</li>
</ul></li>
<li>does not require the user to specify low-level layout logic.</li>
<li>supports output in multiple formats as well as converting a pivot table to either a standard R matrix or data frame.</li>
</ul>
<p>Since pivot tables are primarily visualisation tools, the pivottabler package offers several custom styling options as well as conditional/custom formatting capabilities so that the pivot tables can be themed/branded as needed.</p>
<p>Output can be rendered as:</p>
<ul>
<li>HTML, including via the htmlwidgets framework,</li>
<li>Latex, e.g.to PDF, or</li>
<li>Plain text, e.g.to the console.</li>
</ul>
<p>The generated HTML, Latex and text can also be easily retrieved, e.g.to be used outside of R</p>
<p>The pivot tables can also be exported to Excel, including the styling/formatting.</p>
<p><code>pivottabler</code> is a companion package to the <code>basictabler</code> package. <code>pivottabler</code> is focussed on generating pivot tables and can aggregate data. <code>basictabler</code> does not aggregate data but offers more control of table structure.</p>
<p>The latest version of the pivottabler package can be obtained directly from the <a href="https://github.com/cbailiss/pivottabler/">package repository</a>. Please log any questions not answered by the vignettes or any bug reports <a href="https://github.com/cbailiss/pivottabler/issues">here</a>.</p>
</div>
<div id="pivot-tables" class="section level2">
<h2>Pivot Tables</h2>
<div id="quick-example" class="section level3">
<h3>Quick Example</h3>
<p>An example of a pivot table showing the number of trains operated by different train companies is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="co"># arguments:  qhpvt(dataFrame, rows, columns, calculations, ...)</span>
<span class="kw">qhpvt</span>(bhmtrains, <span class="st">&quot;TOC&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>, <span class="st">&quot;n()&quot;</span>) <span class="co"># TOC = Train Operating Company </span></code></pre></div>
<div id="htmlwidget-bb38c182707597a99021" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-bb38c182707597a99021">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>This example pivot table is explained in more detail later in this vignette.</p>
<p>Examples of pivot tables containing other types of calculation can be found in the examples gallery later in the vignette.</p>
</div>
<div id="definition" class="section level3">
<h3>Definition</h3>
<p>Pivot tables are a common technique for summarising large tables of data into smaller and more easily understood summary tables to answer specific questions.</p>
<p>Starting from a specific question that requires answering, the variables relevant to the question are identified. The distinct values of the fixed variables<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> are rendered as a mixture of row and column headings in the summary table. One or more aggregations of the (numerical) measured variables are added into the body of the table, where the row/column headings act as data groups. The summary table should then yield an answer to the original question.</p>
</div>
<div id="in-reality" class="section level3">
<h3>In reality</h3>
<p>The definition above is probably more difficult to understand than just looking at some examples - several are presented in this vignette. An extended definition is also provided by <a href="https://en.wikipedia.org/wiki/Pivot_table">Wikipedia</a>.</p>
<p>Pivot tables can be found in everyday use within many commercial and non-commercial organisations. Pivot tables feature prominently in applications such as Microsoft Excel, Open Office, etc. More advanced forms are found in Business Intelligence (BI) and Online Analytical Processing (OLAP) tools.</p>
</div>
</div>
<div id="sample-data-trains-in-birmingham" class="section level2">
<h2>Sample Data: Trains in Birmingham</h2>
<p>To build a series of example pivot tables, we will use the <code>bhmtrains</code> data frame. This contains all 83,710 trains that arrived into and/or departed from <a href="https://en.wikipedia.org/wiki/Birmingham_New_Street_station">Birmingham New Street railway station</a> between 1st December 2016 and 28th February 2017. As an example, the following are four trains that arrived into Birmingham New Street at the very start of this time period - note the data has been transposed (otherwise the table would be very wide).</p>
<div id="htmlwidget-2bf39856edb2f2219a52" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-2bf39856edb2f2219a52">{"x":{"tableCss":null,"tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">ServiceId<\/th>\n    <th class=\"ColumnHeader\">33960725<\/th>\n    <th class=\"ColumnHeader\">33961773<\/th>\n    <th class=\"ColumnHeader\">33961591<\/th>\n    <th class=\"ColumnHeader\">33962586<\/th>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">Status<\/td>\n    <td class=\"Cell\">A<\/td>\n    <td class=\"Cell\">A<\/td>\n    <td class=\"Cell\">A<\/td>\n    <td class=\"Cell\">A<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">TOC<\/td>\n    <td class=\"Cell\">London Midland<\/td>\n    <td class=\"Cell\">London Midland<\/td>\n    <td class=\"Cell\">Virgin Trains<\/td>\n    <td class=\"Cell\">Virgin Trains<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">TrainCategory<\/td>\n    <td class=\"Cell\">Express Passenger<\/td>\n    <td class=\"Cell\">Ordinary Passenger<\/td>\n    <td class=\"Cell\">Express Passenger<\/td>\n    <td class=\"Cell\">Express Passenger<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">PowerType<\/td>\n    <td class=\"Cell\">EMU<\/td>\n    <td class=\"Cell\">EMU<\/td>\n    <td class=\"Cell\">DMU<\/td>\n    <td class=\"Cell\">EMU<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">SchedSpeedMPH<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">Origin<\/td>\n    <td class=\"Cell\">EUS<\/td>\n    <td class=\"Cell\">WSL<\/td>\n    <td class=\"Cell\">EUS<\/td>\n    <td class=\"Cell\">EUS<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">OriginGbttDeparture<\/td>\n    <td class=\"Cell\">2016-11-30 21:49:00<\/td>\n    <td class=\"Cell\">2016-11-30 23:40:00<\/td>\n    <td class=\"Cell\">2016-11-30 22:30:00<\/td>\n    <td class=\"Cell\">2016-11-30 23:30:00<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">OriginActualDeparture<\/td>\n    <td class=\"Cell\">2016-11-30 21:49:00<\/td>\n    <td class=\"Cell\">2016-11-30 23:39:00<\/td>\n    <td class=\"Cell\">2016-11-30 22:29:00<\/td>\n    <td class=\"Cell\">2016-11-30 23:30:00<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">GbttArrival<\/td>\n    <td class=\"Cell\">2016-12-01 00:04:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:07:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:40:00<\/td>\n    <td class=\"Cell\">2016-12-01 01:47:00<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">ActualArrival<\/td>\n    <td class=\"Cell\">2016-12-01 00:04:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:05:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:36:00<\/td>\n    <td class=\"Cell\">2016-12-01 01:43:00<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">GbttDeparture<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">ActualDeparture<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n    <td class=\"Cell\">NA<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">Destination<\/td>\n    <td class=\"Cell\">BHM<\/td>\n    <td class=\"Cell\">BHM<\/td>\n    <td class=\"Cell\">BHM<\/td>\n    <td class=\"Cell\">BHM<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">DestinationGbttArrival<\/td>\n    <td class=\"Cell\">2016-12-01 00:04:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:07:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:40:00<\/td>\n    <td class=\"Cell\">2016-12-01 01:47:00<\/td>\n  <\/tr>\n  <tr>\n    <td class=\"RowHeader\">DestinationActualArrival<\/td>\n    <td class=\"Cell\">2016-12-01 00:04:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:05:00<\/td>\n    <td class=\"Cell\">2016-12-01 00:36:00<\/td>\n    <td class=\"Cell\">2016-12-01 01:43:00<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>GbttArrival and GbttDeparture are the scheduled arrival and departure times of the trains at Birmingham New Street, as advertised in the Great Britain Train Timetable (GBTT). Also given are the actual arrival and departure times of the trains at Birmingham New Street. Note that all four of the trains above terminated at New Street, hence they have arrival times but no departure times. The origin and destination stations of each of the trains is also included, in the form of three letter station codes, e.g.BHM = Birmingham New Street. The <code>trainstations</code> data frame (used later in this vignette) includes a lookup from the code to the full station name for all stations.</p>
<p>The first train above:</p>
<ul>
<li>has an identifier of 33960725<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>.</li>
<li>was operated by the London Midland train operating company.</li>
<li>was an express passenger train (=fewer stops).</li>
<li>was scheduled to be operated by an Electric Multiple Unit.</li>
<li>had a scheduled maximum speed of 100mph.</li>
<li>originated at London Euston station.</li>
<li>was scheduled to leave Euston at 21:49 on 30th November 2016.</li>
<li>left on-time (i.e.at 21:49).</li>
<li>was scheduled to arrive at Birmingham New Street at 00:04 on 1st December 2016.</li>
<li>arrived on-time at New Street.</li>
<li>terminated at New Street (so no departure details and the destination was Birmingham New Street).</li>
</ul>
</div>
<div id="basic-pivot-table" class="section level2">
<h2>Basic Pivot Table</h2>
<p>Suppose we want to answer the question: How many ordinary/express passenger trains did each train operating company (TOC) operate in the three month period?</p>
<p>The following code will generate the relevant pivot table:</p>
<!-- Warning=FALSE since the above renderBasicTable seems to cause a random warning in the code below:
## Warning in combine_vars(vars, ind_list): '.Random.seed' is not an integer
## vector but of type 'NULL', so ignored
i.e. disable the renderBasicTable() call and the warning disappears - very odd.
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-f7783ca636a1c8e76894" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-f7783ca636a1c8e76894">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>The code above is the verbose version of the quick-pivot example near the start of this vignette (which used the <code>qhpvt()</code> function). Both produce the same pivot table and output, but the verbose version helps more clearly explain the steps involved in constructing the pivot table.</p>
<p>Each line above works as follows:</p>
<ol style="list-style-type: decimal">
<li>Load the namespace of the pivottabler library.</li>
<li>Create a new pivot table instance<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>.</li>
<li>Specify the data frame that contains the data for the pivot table.</li>
<li>Add the distinct values from the TrainCategory column in the data frame as columns in the pivot table.</li>
<li>Add the distinct values from the TOC column in the data frame as rows in the pivot table.</li>
<li>Specify the calculation. The summarise expression must be an expression that can be used with the dplyr summarise() function. This expression is used internally by the pivottabler package with the dplyr summarise function. <code>pivottabler</code> also supports data.table - see the <a href="v10-performance.html">Performance</a> vignette for more details.</li>
<li>Generate the pivot table.</li>
</ol>
</div>
<div id="constructing-the-basic-pivot-table" class="section level2">
<h2>Constructing the Basic Pivot Table</h2>
<p>The following examples show how each line in the above example constructs the pivot table. To improve readability, each code change is highlighted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># produces no pivot table</span>
<span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-dcf4cf0c84a38e162c64" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-dcf4cf0c84a38e162c64">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <td class=\"Cell\" style=\"text-align: center; padding: 6px\">(no data)<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specify the column headings</span>
<span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)   <span class="co">#    &lt;&lt; **** LINE ADDED **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-a63a77c138e8cb067669" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-a63a77c138e8cb067669">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specify the row headings</span>
<span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)                <span class="co">#    &lt;&lt; **** LINE ADDED **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-111739016a5bc96acb9e" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-111739016a5bc96acb9e">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\"><\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specifying a calculation</span>
<span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)                <span class="co">#     **** LINE BELOW ADDED ****</span>
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-1e3980c89308eb5fe7b0" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-1e3980c89308eb5fe7b0">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="outputting-the-pivot-table-as-plain-text" class="section level2">
<h2>Outputting the Pivot Table as Plain Text</h2>
<p>The pivot table can be rendered as plain text to the console by using <code>pt</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">evaluatePivot</span>()
pt</code></pre></div>
<pre><code>                     Express Passenger  Ordinary Passenger  Total  
Arriva Trains Wales               3079                 830   3909  
CrossCountry                     22865                  63  22928  
London Midland                   14487               33792  48279  
Virgin Trains                     8594                       8594  
Total                            49025               34685  83710  </code></pre>
</div>
<div id="extending-the-basic-pivot-table" class="section level2">
<h2>Extending the Basic Pivot Table</h2>
<p>There follows below a progressive series of changes to the basic pivot table shown above. Each change is made by adding or changing one line of code. Again, to improve readability, each code change is highlighted.</p>
<p>First, adding an additional column data group to sub-divide each TrainCategory by PowerType:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;PowerType&quot;</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-47e169750f75898c0f10" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-47e169750f75898c0f10">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>By default, the new data group does not expand the existing TrainCategory total. However, an additional argument allows the total column to also be expanded:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;PowerType&quot;</span>, <span class="dt">expandExistingTotals=</span><span class="ot">TRUE</span>) <span class="co"># &lt;&lt; ** CODE CHANGE ** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-c8818fe393b076fc0332" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c8818fe393b076fc0332">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22196<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">11229<\/td>\n    <td class=\"Total\">37050<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">2137<\/td>\n    <td class=\"Total\">6457<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">39471<\/td>\n    <td class=\"Total\">43507<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>Instead of adding PowerType as columns, it can also be added as rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;PowerType&quot;</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-572dc17f51c95774eb03" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-572dc17f51c95774eb03">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">Arriva Trains Wales<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">CrossCountry<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">HST<\/th>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">London Midland<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Total\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">37050<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">Virgin Trains<\/th>\n    <th class=\"RowHeader\">DMU<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">EMU<\/th>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>It is possible to continue adding additional data groups. The pivottabler does not enforce a maximum depth of data groups. For example, adding the maximum scheduled speed to the rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;PowerType&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;SchedSpeedMPH&quot;</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-c6072ca790fa09249a27" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c6072ca790fa09249a27">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"5\">Arriva Trains Wales<\/th>\n    <th class=\"RowHeader\" rowspan=\"4\">DMU<\/th>\n    <th class=\"RowHeader\">75<\/th>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\">58<\/td>\n    <td class=\"Total\">121<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\">2989<\/td>\n    <td class=\"Cell\">772<\/td>\n    <td class=\"Total\">3761<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">27<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">27<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"8\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"4\">DMU<\/th>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">10961<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">11024<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">11040<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">11040<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">132<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">132<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">22133<\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22196<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">HST<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">724<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">724<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">8<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">732<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"11\">London Midland<\/th>\n    <th class=\"RowHeader\" rowspan=\"5\">DMU<\/th>\n    <th class=\"RowHeader\">75<\/th>\n    <td class=\"Cell\">845<\/td>\n    <td class=\"Cell\">5259<\/td>\n    <td class=\"Total\">6104<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\">2340<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Total\">2399<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">2450<\/td>\n    <td class=\"Cell\">273<\/td>\n    <td class=\"Total\">2723<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">5638<\/td>\n    <td class=\"Total\">5591<\/td>\n    <td class=\"Total\">11229<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"5\">EMU<\/th>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">17801<\/td>\n    <td class=\"Total\">17801<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">7820<\/td>\n    <td class=\"Cell\">10384<\/td>\n    <td class=\"Total\">18204<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">110<\/th>\n    <td class=\"Cell\">1020<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1020<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Cell\">16<\/td>\n    <td class=\"Total\">25<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">8849<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">37050<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"7\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"3\">DMU<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">2135<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2135<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">2137<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">2137<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"3\">EMU<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">6452<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">6452<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">5<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">6457<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">6457<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>As more data groups are added, the pivot table can seem overwhelmed with totals. It is possible to selectively show/hide totals using the <code>addTotal</code> argument. Totals can be renamed using the <code>totalCaption</code> argument. Both of these options are demonstrated below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
pt &lt;-<span class="st"> </span>PivotTable<span class="op">$</span><span class="kw">new</span>()
pt<span class="op">$</span><span class="kw">addData</span>(bhmtrains)
pt<span class="op">$</span><span class="kw">addColumnDataGroups</span>(<span class="st">&quot;TrainCategory&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;TOC&quot;</span>, <span class="dt">totalCaption=</span><span class="st">&quot;Grand Total&quot;</span>)    <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;PowerType&quot;</span>)
pt<span class="op">$</span><span class="kw">addRowDataGroups</span>(<span class="st">&quot;SchedSpeedMPH&quot;</span>, <span class="dt">addTotal=</span><span class="ot">FALSE</span>)      <span class="co">#    &lt;&lt; **** CODE CHANGE **** &lt;&lt;</span>
pt<span class="op">$</span><span class="kw">defineCalculation</span>(<span class="dt">calculationName=</span><span class="st">&quot;TotalTrains&quot;</span>, <span class="dt">summariseExpression=</span><span class="st">&quot;n()&quot;</span>)
pt<span class="op">$</span><span class="kw">renderPivot</span>()</code></pre></div>
<div id="htmlwidget-f8234a39b767cb0e7eaa" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-f8234a39b767cb0e7eaa">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" colspan=\"3\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">Arriva Trains Wales<\/th>\n    <th class=\"RowHeader\" rowspan=\"3\">DMU<\/th>\n    <th class=\"RowHeader\">75<\/th>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\">58<\/td>\n    <td class=\"Total\">121<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\">2989<\/td>\n    <td class=\"Cell\">772<\/td>\n    <td class=\"Total\">3761<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">27<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">27<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"6\">CrossCountry<\/th>\n    <th class=\"RowHeader\" rowspan=\"3\">DMU<\/th>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">10961<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Total\">11024<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">11040<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">11040<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">132<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">132<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">HST<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">724<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">724<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">8<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"9\">London Midland<\/th>\n    <th class=\"RowHeader\" rowspan=\"4\">DMU<\/th>\n    <th class=\"RowHeader\">75<\/th>\n    <td class=\"Cell\">845<\/td>\n    <td class=\"Cell\">5259<\/td>\n    <td class=\"Total\">6104<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\">2340<\/td>\n    <td class=\"Cell\">59<\/td>\n    <td class=\"Total\">2399<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">2450<\/td>\n    <td class=\"Cell\">273<\/td>\n    <td class=\"Total\">2723<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"4\">EMU<\/th>\n    <th class=\"RowHeader\">90<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">17801<\/td>\n    <td class=\"Total\">17801<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">100<\/th>\n    <td class=\"Cell\">7820<\/td>\n    <td class=\"Cell\">10384<\/td>\n    <td class=\"Total\">18204<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">110<\/th>\n    <td class=\"Cell\">1020<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1020<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">9<\/td>\n    <td class=\"Cell\">16<\/td>\n    <td class=\"Total\">25<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"5\">Virgin Trains<\/th>\n    <th class=\"RowHeader\" rowspan=\"2\">DMU<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">2135<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2135<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">EMU<\/th>\n    <th class=\"RowHeader\">125<\/th>\n    <td class=\"Cell\">6452<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">6452<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">NA<\/th>\n    <td class=\"Cell\">5<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Grand Total<\/th>\n    <th class=\"RowHeader\"><\/th>\n    <th class=\"RowHeader\"><\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="quick-pivot-functions" class="section level2">
<h2>Quick-Pivot Functions</h2>
<p>To construct basic pivot tables quickly, three functions are provided that can construct pivot tables with one line of R:</p>
<ul>
<li><code>qpvt()</code> returns a pivot table. Setting a variable equal to the return value, e.g. <code>pt &lt;- qpvt(...)</code>, allows further operations to be carried out on the pivot table. Otherwise, using <code>qpvt(...)</code> alone will simply print the pivot table to the console and then discard it.</li>
<li><code>qhpvt()</code> returns a HTML widget that when used alone will render a HTML representation of the pivot table (e.g.in the R-Studio Viewer pane).</li>
<li><code>qlpvt()</code> returns a Latex representation of a pivot table.</li>
</ul>
<p>These functions do not offer all of the options that are available when constructing a pivot table using the more verbose syntax.</p>
<p>The arguments to all three functions are essentially the same:</p>
<ul>
<li><code>dataFrame</code> specifies the data frame that contains the pivot table data.</li>
<li><code>rows</code> specifies the names of the variables (as a character vector) used to generate the row data groups.</li>
<li><code>columns</code> specifies the names of the variables (as a character vector) used to generate the column data groups.</li>
<li><code>calculations</code> specifies the summary calculations (as a character vector) used to calculate the cell values in the pivot table. The names of the elements in this vector become the calculation names (and so the calculation headings when more than one calculation is present in the pivot table).</li>
<li><code>format</code> specifies the same formatting for all calculations (as either a character value, list or R function). See the Formatting calculated values section of the Calculations vignette for more details.</li>
<li><code>formats</code> specifies a different format for each calculation (as a list of the same length as <code>calculations</code> containing any combination of character values, lists or R functions).</li>
<li><code>totals</code> specifies which totals are shown and can also control the captions of totals. This is described in more detail below.</li>
</ul>
<p>Specifying = in either the <code>rows</code> or <code>columns</code> vectors sets the position of the calculations in the row/column headings.</p>
<p>A basic example of quickly printing a pivot table to the console:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="kw">qpvt</span>(bhmtrains, <span class="st">&quot;TOC&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>, <span class="st">&quot;n()&quot;</span>)</code></pre></div>
<pre><code>                     Express Passenger  Ordinary Passenger  Total  
Arriva Trains Wales               3079                 830   3909  
CrossCountry                     22865                  63  22928  
London Midland                   14487               33792  48279  
Virgin Trains                     8594                       8594  
Total                            49025               34685  83710  </code></pre>
<p>A slightly more complex pivot table being quickly rendered as a HTML widget, where the calculation headings are on the rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="kw">qhpvt</span>(bhmtrains, <span class="kw">c</span>(<span class="st">&quot;=&quot;</span>, <span class="st">&quot;TOC&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;TrainCategory&quot;</span>, <span class="st">&quot;PowerType&quot;</span>),
    <span class="kw">c</span>(<span class="st">&quot;Number of Trains&quot;</span>=<span class="st">&quot;n()&quot;</span>, <span class="st">&quot;Maximum Speed&quot;</span>=<span class="st">&quot;max(SchedSpeedMPH, na.rm=TRUE)&quot;</span>))</code></pre></div>
<div id="htmlwidget-301af61e0f6c5995d44b" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-301af61e0f6c5995d44b">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\" colspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"5\">Number of Trains<\/th>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"5\">Maximum Speed<\/th>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">90<\/td>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">90<\/td>\n    <td class=\"Total\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">110<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">110<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">110<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">100<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>A quick pivot table with a format specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="kw">qhpvt</span>(bhmtrains, <span class="st">&quot;TOC&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>, <span class="st">&quot;mean(SchedSpeedMPH, na.rm=TRUE)&quot;</span>, <span class="dt">format=</span><span class="st">&quot;%.0f&quot;</span>)</code></pre></div>
<div id="htmlwidget-a85ad9a181ba3d7ce16f" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-a85ad9a181ba3d7ce16f">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">89<\/td>\n    <td class=\"Total\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">113<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Total\">113<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">98<\/td>\n    <td class=\"Cell\">91<\/td>\n    <td class=\"Total\">93<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">109<\/td>\n    <td class=\"Total\">91<\/td>\n    <td class=\"Total\">101<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>A quick pivot table with two calculations that are formatted differently:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="kw">qhpvt</span>(bhmtrains, <span class="st">&quot;TOC&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>, 
     <span class="kw">c</span>(<span class="st">&quot;Mean Speed&quot;</span>=<span class="st">&quot;mean(SchedSpeedMPH, na.rm=TRUE)&quot;</span>, <span class="st">&quot;Std Dev Speed&quot;</span>=<span class="st">&quot;sd(SchedSpeedMPH, na.rm=TRUE)&quot;</span>), 
     <span class="dt">formats=</span><span class="kw">list</span>(<span class="st">&quot;%.0f&quot;</span>, <span class="st">&quot;%.1f&quot;</span>))</code></pre></div>
<div id="htmlwidget-1184aa08b04da58fa0ee" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-1184aa08b04da58fa0ee">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">2.1<\/td>\n    <td class=\"Cell\">89<\/td>\n    <td class=\"Cell\">3.8<\/td>\n    <td class=\"Total\">90<\/td>\n    <td class=\"Total\">2.6<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">113<\/td>\n    <td class=\"Cell\">12.5<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">0.0<\/td>\n    <td class=\"Total\">113<\/td>\n    <td class=\"Total\">12.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">98<\/td>\n    <td class=\"Cell\">7.4<\/td>\n    <td class=\"Cell\">91<\/td>\n    <td class=\"Cell\">8.1<\/td>\n    <td class=\"Total\">93<\/td>\n    <td class=\"Total\">8.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">0.0<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">0.0<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">109<\/td>\n    <td class=\"Total\">14.2<\/td>\n    <td class=\"Total\">91<\/td>\n    <td class=\"Total\">8.1<\/td>\n    <td class=\"Total\">101<\/td>\n    <td class=\"Total\">15.1<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>In the above pivot table, the Total would be better renamed to something like All or Overall since a total for a mean or standard deviation does not make complete sense.</p>
<p>Totals can be controlled using the <code>totals</code> argument. This works as follows:</p>
<ul>
<li>If not specified, then totals are generated for all variables.</li>
<li>To hide all totals, specify <code>totals=NONE</code>.</li>
<li>To specify which variables have totals, specify the names of the variables in a character vector, e.g.in a pivot table containing the variables x, y and z, to display totals only for variables x and z, specify <code>totals=c(&quot;x&quot;, &quot;z&quot;)</code>.</li>
<li>To specify which variables have totals and also rename the captions of the total cells, specify a list, e.g.to rename the totals for x to All x and y to All y, specify <code>totals=list(&quot;x&quot;=&quot;All x&quot;, &quot;y&quot;=&quot;All y&quot;)</code>.</li>
</ul>
<p>Returning to the previous quick pivot example, the totals can now be renamed to All  using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pivottabler)
<span class="kw">qhpvt</span>(bhmtrains, <span class="st">&quot;TOC&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>, 
     <span class="kw">c</span>(<span class="st">&quot;Mean Speed&quot;</span>=<span class="st">&quot;mean(SchedSpeedMPH, na.rm=TRUE)&quot;</span>, <span class="st">&quot;Std Dev Speed&quot;</span>=<span class="st">&quot;sd(SchedSpeedMPH, na.rm=TRUE)&quot;</span>), 
     <span class="dt">formats=</span><span class="kw">list</span>(<span class="st">&quot;%.0f&quot;</span>, <span class="st">&quot;%.1f&quot;</span>), <span class="dt">totals=</span><span class="kw">list</span>(<span class="st">&quot;TOC&quot;</span>=<span class="st">&quot;All TOCs&quot;</span>, <span class="st">&quot;TrainCategory&quot;</span>=<span class="st">&quot;All Categories&quot;</span>))</code></pre></div>
<div id="htmlwidget-e74d15db84dfde9998c5" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-e74d15db84dfde9998c5">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"2\">All Categories<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n    <th class=\"ColumnHeader\">Mean Speed<\/th>\n    <th class=\"ColumnHeader\">Std Dev Speed<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">90<\/td>\n    <td class=\"Cell\">2.1<\/td>\n    <td class=\"Cell\">89<\/td>\n    <td class=\"Cell\">3.8<\/td>\n    <td class=\"Total\">90<\/td>\n    <td class=\"Total\">2.6<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">113<\/td>\n    <td class=\"Cell\">12.5<\/td>\n    <td class=\"Cell\">100<\/td>\n    <td class=\"Cell\">0.0<\/td>\n    <td class=\"Total\">113<\/td>\n    <td class=\"Total\">12.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">98<\/td>\n    <td class=\"Cell\">7.4<\/td>\n    <td class=\"Cell\">91<\/td>\n    <td class=\"Cell\">8.1<\/td>\n    <td class=\"Total\">93<\/td>\n    <td class=\"Total\">8.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">125<\/td>\n    <td class=\"Cell\">0.0<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">125<\/td>\n    <td class=\"Total\">0.0<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">All TOCs<\/th>\n    <td class=\"Total\">109<\/td>\n    <td class=\"Total\">14.2<\/td>\n    <td class=\"Total\">91<\/td>\n    <td class=\"Total\">8.1<\/td>\n    <td class=\"Total\">101<\/td>\n    <td class=\"Total\">15.1<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="examples-gallery" class="section level2">
<h2>Examples Gallery</h2>
<p>This section shows some examples from the other vignettes as a quick overview of some of the other capabilities of the pivottabler package. The R scripts to create each example below can be found in the other vignettes.</p>
<div id="multiple-levels-formatted-data-groups" class="section level3">
<h3>Multiple Levels &amp; Formatted Data Groups</h3>
<div id="htmlwidget-c66779f888c1a0f2bb2c" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-c66779f888c1a0f2bb2c">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">December 2016<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">January 2017<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">February 2017<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">1291<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1291<\/td>\n    <td class=\"Cell\">1402<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1402<\/td>\n    <td class=\"Cell\">1216<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">1216<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">7314<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">236<\/td>\n    <td class=\"Total\">7550<\/td>\n    <td class=\"Cell\">7777<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">256<\/td>\n    <td class=\"Total\">8033<\/td>\n    <td class=\"Cell\">7105<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">240<\/td>\n    <td class=\"Total\">7345<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">3635<\/td>\n    <td class=\"Cell\">11967<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">15602<\/td>\n    <td class=\"Cell\">3967<\/td>\n    <td class=\"Cell\">13062<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">17029<\/td>\n    <td class=\"Cell\">3627<\/td>\n    <td class=\"Cell\">12021<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">15648<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">740<\/td>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2877<\/td>\n    <td class=\"Cell\">728<\/td>\n    <td class=\"Cell\">2276<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3004<\/td>\n    <td class=\"Cell\">669<\/td>\n    <td class=\"Cell\">2044<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">2713<\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">12980<\/td>\n    <td class=\"Total\">14104<\/td>\n    <td class=\"Total\">236<\/td>\n    <td class=\"Total\">27320<\/td>\n    <td class=\"Total\">13874<\/td>\n    <td class=\"Total\">15338<\/td>\n    <td class=\"Total\">256<\/td>\n    <td class=\"Total\">29468<\/td>\n    <td class=\"Total\">12617<\/td>\n    <td class=\"Total\">14065<\/td>\n    <td class=\"Total\">240<\/td>\n    <td class=\"Total\">26922<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v02-datagroups.html">Data Groups</a> vignette for more details.</p>
</div>
<div id="multiple-calculations-calculations-on-rows" class="section level3">
<h3>Multiple Calculations &amp; Calculations on Rows</h3>
<div id="htmlwidget-6f4c24ce356450f9e127" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f4c24ce356450f9e127">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Arriva Trains Wales<\/th>\n    <th class=\"ColumnHeader\">CrossCountry<\/th>\n    <th class=\"ColumnHeader\">London Midland<\/th>\n    <th class=\"ColumnHeader\">Virgin Trains<\/th>\n    <th class=\"ColumnHeader\">All TOCs<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total Trains<\/th>\n    <td class=\"Cell\">3909<\/td>\n    <td class=\"Cell\">22928<\/td>\n    <td class=\"Cell\">48279<\/td>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Min Arr. Delay<\/th>\n    <td class=\"Cell\">0<\/td>\n    <td class=\"Cell\">0<\/td>\n    <td class=\"Cell\">0<\/td>\n    <td class=\"Cell\">0<\/td>\n    <td class=\"Total\">0<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Max Arr. Delay<\/th>\n    <td class=\"Cell\">49<\/td>\n    <td class=\"Cell\">273<\/td>\n    <td class=\"Cell\">177<\/td>\n    <td class=\"Cell\">181<\/td>\n    <td class=\"Total\">273<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Mean Arr. Delay<\/th>\n    <td class=\"Cell\">2.3<\/td>\n    <td class=\"Cell\">3.5<\/td>\n    <td class=\"Cell\">2.3<\/td>\n    <td class=\"Cell\">3.0<\/td>\n    <td class=\"Total\">2.7<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Median Arr. Delay<\/th>\n    <td class=\"Cell\">1<\/td>\n    <td class=\"Cell\">2<\/td>\n    <td class=\"Cell\">1<\/td>\n    <td class=\"Cell\">0<\/td>\n    <td class=\"Total\">1<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Delay IQR<\/th>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Cell\">4<\/td>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Cell\">3<\/td>\n    <td class=\"Total\">3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Delay Std. Dev.<\/th>\n    <td class=\"Cell\">4.3<\/td>\n    <td class=\"Cell\">8.1<\/td>\n    <td class=\"Cell\">4.2<\/td>\n    <td class=\"Cell\">8.4<\/td>\n    <td class=\"Total\">6.1<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v03-calculations.html">Calculations</a> vignette for more details.</p>
</div>
<div id="custom-calculations" class="section level3">
<h3>Custom Calculations</h3>
<div id="htmlwidget-7b767507ce2436dc99db" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-7b767507ce2436dc99db">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">December 2016<\/th>\n    <th class=\"ColumnHeader\">January 2017<\/th>\n    <th class=\"ColumnHeader\">February 2017<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">Tue 27:  42.9 %<\/td>\n    <td class=\"Cell\">Sun 29:  18.8 %<\/td>\n    <td class=\"Cell\">Sun 12:  18.8 %<\/td>\n    <td class=\"Total\">Tue 27:  42.9 %<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">Thu 01:  35.4 %<\/td>\n    <td class=\"Cell\">Fri 06:  19.4 %<\/td>\n    <td class=\"Cell\">Thu 23:  27.9 %<\/td>\n    <td class=\"Total\">Thu 01:  35.4 %<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">Thu 01:  26.9 %<\/td>\n    <td class=\"Cell\">Fri 06:  17.2 %<\/td>\n    <td class=\"Cell\">Thu 23:  12.1 %<\/td>\n    <td class=\"Total\">Thu 01:  26.9 %<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">Thu 01:  33.0 %<\/td>\n    <td class=\"Cell\">Thu 12:  21.4 %<\/td>\n    <td class=\"Cell\">Sat 11:  25.5 %<\/td>\n    <td class=\"Total\">Thu 01:  33.0 %<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">All TOCs<\/th>\n    <td class=\"Total\">Thu 01:  29.5 %<\/td>\n    <td class=\"Total\">Fri 06:  16.3 %<\/td>\n    <td class=\"Total\">Thu 23:  17.1 %<\/td>\n    <td class=\"Total\">Thu 01:  29.5 %<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v03-calculations.html">Calculations</a> vignette for more details.</p>
</div>
<div id="results-as-a-matrix" class="section level3">
<h3>Results as a Matrix</h3>
<pre><code>     [,1]                  [,2]    [,3]    [,4]  [,5]   
[1,] &quot;&quot;                    &quot;DMU&quot;   &quot;EMU&quot;   &quot;HST&quot; &quot;Total&quot;
[2,] &quot;Arriva Trains Wales&quot; &quot;3909&quot;  &quot;&quot;      &quot;&quot;    &quot;3909&quot; 
[3,] &quot;CrossCountry&quot;        &quot;22196&quot; &quot;&quot;      &quot;732&quot; &quot;22928&quot;
[4,] &quot;London Midland&quot;      &quot;11229&quot; &quot;37050&quot; &quot;&quot;    &quot;48279&quot;
[5,] &quot;Virgin Trains&quot;       &quot;2137&quot;  &quot;6457&quot;  &quot;&quot;    &quot;8594&quot; 
[6,] &quot;Total&quot;               &quot;39471&quot; &quot;43507&quot; &quot;732&quot; &quot;83710&quot;</code></pre>
<p>See the <a href="v04-outputs.html">Outputs</a> vignette for more details, including other conversion options such as converting a pivot table to a data frame.</p>
</div>
<div id="latex-output" class="section level3">
<h3>Latex Output</h3>
<div class="figure">
<img src="data:image/png;base64,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" alt="Latex Output" />
<p class="caption">Latex Output</p>
</div>
<p>See the <a href="v05-latexoutput.html">Latex Output</a> vignette for more details.</p>
</div>
<div id="styling" class="section level3">
<h3>Styling</h3>
<div id="htmlwidget-052ffb0a08e1a811e959" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-052ffb0a08e1a811e959">{"x":{"tableCss":".t3Table {border-collapse: collapse; border: 2px solid rgb(48, 84, 150); }\r\n.t3ColumnHeader {font-family: Verdana, Arial; font-size: 0.75em; padding: 2px; border: 1px solid rgb(48, 84, 150); vertical-align: middle; text-align: center; font-weight: bold; color: rgb(255, 255, 255); background-color: rgb(68, 114, 196); }\r\n.t3RowHeader {font-family: Verdana, Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid rgb(48, 84, 150); vertical-align: middle; text-align: left; font-weight: bold; color: rgb(255, 255, 255); background-color: rgb(68, 114, 196); }\r\n.t3Cell {font-family: Verdana, Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid rgb(48, 84, 150); vertical-align: middle; text-align: right; color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); }\r\n.t3Total {font-family: Verdana, Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid rgb(48, 84, 150); vertical-align: middle; text-align: right; color: rgb(0, 0, 0); background-color: rgb(186, 202, 233); }\r\n","tableHtml":"<table class=\"t3Table\">\n  <tr>\n    <th class=\"t3ColumnHeader\">&nbsp;<\/th>\n    <th class=\"t3ColumnHeader\">Express Passenger<\/th>\n    <th class=\"t3ColumnHeader\">Ordinary Passenger<\/th>\n    <th class=\"t3ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"t3RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"t3Cell\">3079<\/td>\n    <td class=\"t3Cell\">830<\/td>\n    <td class=\"t3Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"t3RowHeader\">CrossCountry<\/th>\n    <td class=\"t3Cell\">22865<\/td>\n    <td class=\"t3Cell\">63<\/td>\n    <td class=\"t3Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"t3RowHeader\">London Midland<\/th>\n    <td class=\"t3Cell\">14487<\/td>\n    <td class=\"t3Cell\">33792<\/td>\n    <td class=\"t3Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"t3RowHeader\">Virgin Trains<\/th>\n    <td class=\"t3Cell\">8594<\/td>\n    <td class=\"t3Cell\"><\/td>\n    <td class=\"t3Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"t3RowHeader\">Total<\/th>\n    <td class=\"t3Total\">49025<\/td>\n    <td class=\"t3Total\">34685<\/td>\n    <td class=\"t3Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v06-styling.html">Styling</a> vignette for more details.</p>
</div>
<div id="finding-and-formatting-data-groups" class="section level3">
<h3>Finding and Formatting Data Groups</h3>
<div id="htmlwidget-a03a8d2d32f91cddc944" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-a03a8d2d32f91cddc944">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: #FFFF00; \" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: #FFFF00; \">DMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: #FFFF00; \">EMU<\/th>\n    <th class=\"ColumnHeader\" style=\"background-color: #FFFF00; \">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22133<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\">732<\/td>\n    <td class=\"Total\">22865<\/td>\n    <td class=\"Cell\">63<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">63<\/td>\n    <td class=\"Total\">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v07-findingandformatting.html">Finding and Formatting</a> vignette for more details.</p>
</div>
<div id="finding-and-formatting-cells" class="section level3">
<h3>Finding and Formatting Cells</h3>
<div id="htmlwidget-3ae503f48563a5a47a63" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-3ae503f48563a5a47a63">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\" colspan=\"4\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\" colspan=\"3\">Ordinary Passenger<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">HST<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n    <th class=\"ColumnHeader\">EMU<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n    <th class=\"ColumnHeader\"><\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">3079<\/td>\n    <td class=\"Cell\">830<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\">830<\/td>\n    <td class=\"Total\">3909<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\" style=\"background-color: #00FF00; \">22133<\/td>\n    <td class=\"Cell\" style=\"background-color: #00FF00; \"><\/td>\n    <td class=\"Cell\" style=\"background-color: #00FF00; \">732<\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">22865<\/td>\n    <td class=\"Cell\" style=\"background-color: #00FF00; \">63<\/td>\n    <td class=\"Cell\" style=\"background-color: #00FF00; \"><\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">63<\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">22928<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">5638<\/td>\n    <td class=\"Cell\">8849<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">14487<\/td>\n    <td class=\"Cell\">5591<\/td>\n    <td class=\"Cell\">28201<\/td>\n    <td class=\"Total\">33792<\/td>\n    <td class=\"Total\">48279<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">2137<\/td>\n    <td class=\"Cell\">6457<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">8594<\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Total\"><\/td>\n    <td class=\"Total\">8594<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">32987<\/td>\n    <td class=\"Total\">15306<\/td>\n    <td class=\"Total\">732<\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">49025<\/td>\n    <td class=\"Total\">6484<\/td>\n    <td class=\"Total\">28201<\/td>\n    <td class=\"Total\" style=\"background-color: #00FF00; \">34685<\/td>\n    <td class=\"Total\">83710<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v07-findingandformatting.html">Finding and Formatting</a> vignette for more details.</p>
</div>
<div id="conditional-formatting" class="section level3">
<h3>Conditional Formatting</h3>
<div id="htmlwidget-28e6c859e57f1d07cda5" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-28e6c859e57f1d07cda5">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">5<\/th>\n    <th class=\"ColumnHeader\">6<\/th>\n    <th class=\"ColumnHeader\">7<\/th>\n    <th class=\"ColumnHeader\">8<\/th>\n    <th class=\"ColumnHeader\">9<\/th>\n    <th class=\"ColumnHeader\">10<\/th>\n    <th class=\"ColumnHeader\">Total<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Birmingham International<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #d3eec3; color: #235f00; \">0.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #d7eebf; color: #2e5e00; \">0.9<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdfad; color: #9c3902; \">2.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #fbeb9f; color: #915800; \">1.9<\/td>\n    <td class=\"Cell\" style=\"background-color: #eeecaa; color: #6f5a00; \">1.6<\/td>\n    <td class=\"Total\" style=\"background-color: #f5eca4; color: #825900; \">1.7<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Bournemouth<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">5.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Cardiff Central<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">5.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd8b6; color: #9c2903; \">3.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">5.3<\/td>\n    <td class=\"Total\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.2<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Four Oaks<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #dcedbb; color: #3b5d00; \">1.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #d1eec4; color: #1f5f00; \">0.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdead; color: #9c3902; \">2.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffea9e; color: #9c5400; \">2.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe5a5; color: #9c4801; \">2.3<\/td>\n    <td class=\"Total\" style=\"background-color: #fceb9e; color: #945700; \">1.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Glasgow Central<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdcb1; color: #9c3203; \">2.9<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdcb1; color: #9c3203; \">2.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Hereford<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ebecad; color: #665a00; \">1.5<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd1c0; color: #9c1804; \">3.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd1c1; color: #9c1704; \">3.5<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdbb3; color: #9c2f03; \">2.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Leicester<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe8a0; color: #9c5000; \">2.2<\/td>\n    <td class=\"Cell\" style=\"background-color: #daeebc; color: #375d00; \">1.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.5<\/td>\n    <td class=\"Cell\" style=\"background-color: #e6edb2; color: #585b00; \">1.3<\/td>\n    <td class=\"Cell\" style=\"background-color: #eeecab; color: #6d5a00; \">1.6<\/td>\n    <td class=\"Total\" style=\"background-color: #f8eba2; color: #8a5800; \">1.8<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Lichfield City<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.6<\/td>\n    <td class=\"Cell\" style=\"background-color: #e8edb0; color: #5d5b00; \">1.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.2<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd7b8; color: #9c2703; \">3.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe0ab; color: #9c3d02; \">2.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdbb2; color: #9c3103; \">2.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Lichfield Trent Valley<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #f2eca7; color: #7a5900; \">1.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdcb1; color: #9c3203; \">2.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffcbc8; color: #9c0a05; \">3.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd7b7; color: #9c2703; \">3.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe0ac; color: #9c3c02; \">2.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdbb2; color: #9c3003; \">2.9<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Liverpool Lime Street<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd1c0; color: #9c1904; \">3.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd7b8; color: #9c2703; \">3.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffddaf; color: #9c3502; \">2.8<\/td>\n    <td class=\"Total\" style=\"background-color: #ffd7b8; color: #9c2703; \">3.1<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Euston<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #e5edb3; color: #545c00; \">1.3<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe2a8; color: #9c4201; \">2.5<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd7b8; color: #9c2703; \">3.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe0ac; color: #9c3b02; \">2.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdfac; color: #9c3a02; \">2.7<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Longbridge<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #d0eec6; color: #1a5f00; \">0.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffeb9c; color: #9c5700; \">2.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd6b9; color: #9c2404; \">3.2<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffddb0; color: #9c3402; \">2.8<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdead; color: #9c3902; \">2.7<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Manchester Piccadilly<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #faeba0; color: #8e5800; \">1.9<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe3a8; color: #9c4301; \">2.5<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd7b8; color: #9c2603; \">3.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe7a2; color: #9c4d01; \">2.2<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe6a3; color: #9c4a01; \">2.3<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe2a9; color: #9c4102; \">2.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Nottingham<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #d1eec4; color: #1f5f00; \">0.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffea9e; color: #9c5400; \">2.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd3bd; color: #9c1d04; \">3.3<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdbb3; color: #9c3003; \">2.9<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe6a3; color: #9c4b01; \">2.3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Redditch<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ceeec7; color: #166000; \">0.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffddaf; color: #9c3602; \">2.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffddaf; color: #9c3602; \">2.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdab3; color: #9c2f03; \">2.9<\/td>\n    <td class=\"Cell\" style=\"background-color: #efecaa; color: #715a00; \">1.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe5a5; color: #9c4801; \">2.4<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Rugeley Trent Valley<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffea9d; color: #9c5600; \">2.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #f1eca8; color: #755900; \">1.6<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffcdc5; color: #9c0f05; \">3.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe6a4; color: #9c4a01; \">2.3<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe4a5; color: #9c4701; \">2.4<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe2a9; color: #9c4002; \">2.5<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Shrewsbury<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.2<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffeb9c; color: #9c5700; \">2.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffc7ce; color: #9c0006; \">4.3<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffeb9c; color: #9c5700; \">2.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffe8a0; color: #9c4f01; \">2.2<\/td>\n    <td class=\"Total\" style=\"background-color: #ffd9b4; color: #9c2d03; \">3.0<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Stansted Airport<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #ffcfc2; color: #9c1405; \">3.5<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdfac; color: #9c3a02; \">2.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffcfc3; color: #9c1305; \">3.6<\/td>\n    <td class=\"Total\" style=\"background-color: #ffd4bb; color: #9c2004; \">3.3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Walsall<\/th>\n    <td class=\"Cell\"><\/td>\n    <td class=\"Cell\" style=\"background-color: #dcedbb; color: #3b5d00; \">1.1<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffcdc6; color: #9c0e05; \">3.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffd8b6; color: #9c2a03; \">3.0<\/td>\n    <td class=\"Cell\" style=\"background-color: #f2eca8; color: #775900; \">1.6<\/td>\n    <td class=\"Cell\" style=\"background-color: #f6eca4; color: #845900; \">1.8<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe5a4; color: #9c4a01; \">2.3<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Wolverhampton<\/th>\n    <td class=\"Cell\" style=\"background-color: #d0eec5; color: #1c5f00; \">0.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #e8edb0; color: #5c5b00; \">1.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #e9edaf; color: #605b00; \">1.4<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffddaf; color: #9c3602; \">2.8<\/td>\n    <td class=\"Cell\" style=\"background-color: #ffdeae; color: #9c3802; \">2.7<\/td>\n    <td class=\"Cell\" style=\"background-color: #f8eba2; color: #895800; \">1.8<\/td>\n    <td class=\"Total\" style=\"background-color: #f8eba2; color: #8a5800; \">1.8<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\" style=\"background-color: #d0eec5; color: #1c5f00; \">0.8<\/td>\n    <td class=\"Total\" style=\"background-color: #f4eca6; color: #7d5900; \">1.7<\/td>\n    <td class=\"Total\" style=\"background-color: #faeba0; color: #8f5800; \">1.9<\/td>\n    <td class=\"Total\" style=\"background-color: #ffd6b9; color: #9c2503; \">3.1<\/td>\n    <td class=\"Total\" style=\"background-color: #ffdcb1; color: #9c3302; \">2.8<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe3a8; color: #9c4201; \">2.5<\/td>\n    <td class=\"Total\" style=\"background-color: #ffe2a9; color: #9c4002; \">2.5<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v07-findingandformatting.html">Finding and Formatting</a> vignette for more details.</p>
</div>
<div id="irregular-layout" class="section level3">
<h3>Irregular Layout</h3>
<div id="htmlwidget-470145e3bd683ce4868a" style="width:auto;height:auto;" class="pivottabler html-widget"></div>
<script type="application/json" data-for="htmlwidget-470145e3bd683ce4868a">{"x":{"tableCss":".Table {border-collapse: collapse; }\r\n.ColumnHeader {font-family: Arial; font-size: 0.75em; padding: 2px; border: 1px solid lightgray; vertical-align: middle; text-align: center; font-weight: bold; background-color: #F2F2F2; }\r\n.RowHeader {font-family: Arial; font-size: 0.75em; padding: 2px 8px 2px 2px; border: 1px solid lightgray; vertical-align: middle; text-align: left; font-weight: bold; background-color: #F2F2F2; }\r\n.Cell {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n.Total {font-family: Arial; font-size: 0.75em; padding: 2px 2px 2px 8px; border: 1px solid lightgray; vertical-align: middle; text-align: right; }\r\n","tableHtml":"<table class=\"Table\">\n  <tr>\n    <th class=\"RowHeader\" rowspan=\"2\">&nbsp;<\/th>\n    <th class=\"ColumnHeader\">Express Passenger<\/th>\n    <th class=\"ColumnHeader\">DMU<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"ColumnHeader\">Count<\/th>\n    <th class=\"ColumnHeader\">Maximum Speed<\/th>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Arriva Trains Wales<\/th>\n    <td class=\"Cell\">3079<\/td>\n    <td class=\"Cell\">90<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">CrossCountry<\/th>\n    <td class=\"Cell\">22865<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">London Midland<\/th>\n    <td class=\"Cell\">14487<\/td>\n    <td class=\"Cell\">100<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Virgin Trains<\/th>\n    <td class=\"Cell\">8594<\/td>\n    <td class=\"Cell\">125<\/td>\n  <\/tr>\n  <tr>\n    <th class=\"RowHeader\">Total<\/th>\n    <td class=\"Total\">49025<\/td>\n    <td class=\"Total\">125<\/td>\n  <\/tr>\n<\/table>","settings":[]},"evals":[],"jsHooks":[]}</script>
<p>See the <a href="v09-irregularlayout.html">Irregular Layout</a> vignette for more details.</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2>Further Reading</h2>
<p>The full set of vignettes is:</p>
<ol style="list-style-type: decimal">
<li><a href="v01-introduction.html">Introduction</a></li>
<li><a href="v02-datagroups.html">Data Groups</a></li>
<li><a href="v03-calculations.html">Calculations</a></li>
<li><a href="v04-outputs.html">Outputs</a></li>
<li><a href="v05-latexoutput.html">Latex Output</a></li>
<li><a href="v06-styling.html">Styling</a></li>
<li><a href="v07-findingandformatting.html">Finding and Formatting</a></li>
<li><a href="v08-cellcontext.html">Cell Context</a></li>
<li><a href="v09-irregularlayout.html">Irregular Layout</a></li>
<li><a href="v10-performance.html">Performance</a></li>
<li><a href="v11-shiny.html">Shiny</a></li>
<li><a href="v12-excelexport.html">Excel Export</a></li>
<li><a href="vA1-appendix.html">Appendix: Details</a></li>
<li><a href="vA2-appendix.html">Appendix: Calculations</a></li>
<li><a href="vA3-appendix.html">Appendix: Class Overview</a></li>
</ol>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The terms fixed variables and measured variables are used here as in <a href="http://vita.had.co.nz/papers/tidy-data.html">Wickham 2014</a><a href="#fnref1"></a></p></li>
<li id="fn2"><p>This is the identifier assigned by the <a href="http://www.recenttraintimes.co.uk">Recent Train Times</a> website, the source of this sample data<a href="#fnref2"></a></p></li>
<li id="fn3"><p>pivottabler is implemented in <a href="https://CRAN.R-project.org/package=R6">R6 Classes</a> so pt here is an instance of the R6 PivotTable class.<a href="#fnref3"></a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
